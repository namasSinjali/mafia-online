import{R as On}from"./control.CYgJF_JY.js";import{n as An,l as jn,o as Rn,p as In,S as ge,i as me,g as oe,b as g,f as ae,t as _,c as T,a as E,m as C,d as O,e as _s,j as Pt,h as qt}from"./index.CFtv7C9K.js";import{a as Se}from"./Toaster.svelte_svelte_type_style_lang.D6Scgey8.js";import{n as de,N as Ln,a as _e,C as le,j as $,g as m,a3 as $e,m as ze,o as z,p as he,x as Ge,e as J,c as G,d as te,a6 as Be,a9 as Ft,q as Pe,u as Te,v as Ee,w as Ce,ac as Hr,ad as Dn,b as F,h as H,B as Nt,r as Vr,z as gs,a7 as os,a8 as Us,i as Jr,y as X,k as I,t as Y,f as Z,l as ye,F as Ms,a5 as Ht,L as Tt,A as at,a4 as Nn}from"./scheduler.DVhHAZ8e.js";import{_ as lt}from"./preload-helper.D6kgxu3v.js";import{m as Ut,k as Gr,z as wt,f as Kr,j as Mt,t as Bt,p as Un,v as Mn,g as ke,a as Le,I as Ke,x as qe,A as Wr,C as ms,e as be,u as ct,D as ut,B as Je,E as Bn}from"./Icon.D6wECqRG.js";import{t as ps,o as Qr,f as vs,r as bs,g as ys,h as Xr,C as ws,a as $s,b as ks,c as Ss,d as Ps,e as Ts,L as Yr,R as zn,T as qn,P as Fn,I as Hn}from"./index.cqNmkSJw.js";import{w as Zr}from"./index.BH7uu1Dm.js";function ht(i,e,t,s){if(!e)return de;const r=i.getBoundingClientRect();if(e.left===r.left&&e.right===r.right&&e.top===r.top&&e.bottom===r.bottom)return de;const{delay:n=0,duration:o=300,easing:a=Ln,start:l=An()+n,end:c=l+o,tick:u=de,css:f}=t(i,{from:e,to:r},s);let h=!0,d=!1,p;function b(){f&&(p=Rn(i,0,1,o,n,a,f)),n||(d=!0)}function v(){f&&In(i,p),h=!1}return jn(k=>{if(!d&&k>=l&&(d=!0),d&&k>=c&&(u(1,0),v()),!h)return!1;if(d){const y=k-l,V=0+1*a(y/o);u(V,1-V)}return!0}),b(),u(0,1),v}function dt(i){const e=getComputedStyle(i);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:s}=e,r=i.getBoundingClientRect();i.style.position="absolute",i.style.width=t,i.style.height=s,Et(i,r)}}function Et(i,e){const t=i.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const s=getComputedStyle(i),r=s.transform==="none"?"":s.transform;i.style.transform=`${r} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}const Vn={orientation:"horizontal",decorative:!1},Jn=i=>{const e={...Vn,...i},t=ps(e),{orientation:s,decorative:r}=t;return{elements:{root:Ut("separator",{stores:[s,r],returned:([o,a])=>({role:a?"none":"separator","aria-orientation":o==="vertical"?o:void 0,"aria-hidden":a,"data-orientation":o})})},options:t}},Gn={defaultChecked:!1,disabled:!1,required:!1,name:"",value:""},{name:Bs}=Mn("switch");function Kn(i){const e={...Gn,...i},t=ps(Gr(e,"checked")),{disabled:s,required:r,name:n,value:o}=t,a=e.checked??Zr(e.defaultChecked),l=Qr(a,e==null?void 0:e.onCheckedChange);function c(){s.get()||l.update(h=>!h)}const u=Ut(Bs(),{stores:[l,s,r],returned:([h,d,p])=>({"data-disabled":wt(d),disabled:wt(d),"data-state":h?"checked":"unchecked",type:"button",role:"switch","aria-checked":h?"true":"false","aria-required":p?"true":void 0}),action(h){return{destroy:Kr(Mt(h,"click",()=>{c()}),Mt(h,"keydown",p=>{p.key!==Bt.ENTER&&p.key!==Bt.SPACE||(p.preventDefault(),c())}))}}}),f=Ut(Bs("input"),{stores:[l,n,r,s,o],returned:([h,d,p,b,v])=>({type:"checkbox","aria-hidden":!0,hidden:!0,tabindex:-1,name:d,value:v,checked:h,required:p,disabled:wt(b),style:Un({position:"absolute",opacity:0,"pointer-events":"none",margin:0,transform:"translateX(-100%)"})})});return{elements:{root:u,input:f},states:{checked:l},options:t}}const Wn={defaultPressed:!1,disabled:!1};function Qn(i){const e={...Wn,...i},t=ps(Gr(e,"pressed")),{disabled:s}=t,r=e.pressed??Zr(e.defaultPressed),n=Qr(r,e==null?void 0:e.onPressedChange);function o(){s.get()||n.update(c=>!c)}return{elements:{root:Ut("toggle",{stores:[n,s],returned:([l,c])=>({"data-disabled":wt(c),disabled:wt(c),"data-state":l?"on":"off","aria-pressed":l,type:"button"}),action:l=>({destroy:Kr(Mt(l,"click",()=>{o()}),Mt(l,"keydown",u=>{u.key!==Bt.ENTER&&u.key!==Bt.SPACE||(u.preventDefault(),o())}))})})},states:{pressed:n},options:t}}function Xn(){return{NAME:"separator",PARTS:["root"]}}function Yn(i){const{NAME:e,PARTS:t}=Xn(),s=vs(e,t),r={...Jn(bs(i)),getAttrs:s};return{...r,updateOption:ys(r.options)}}const Zn=i=>({builder:i&4}),zs=i=>({builder:i[2]});function xn(i){let e,t,s,r=[i[2],i[4]],n={};for(let o=0;o<r.length;o+=1)n=z(n,r[o]);return{c(){e=J("div"),this.h()},l(o){e=G(o,"DIV",{}),te(e).forEach(m),this.h()},h(){Be(e,n)},m(o,a){$(o,e,a),i[10](e),t||(s=Ft(i[2].action(e)),t=!0)},p(o,a){Be(e,n=ke(r,[a&4&&o[2],a&16&&o[4]]))},i:de,o:de,d(o){o&&m(e),i[10](null),t=!1,s()}}}function ei(i){let e;const t=i[9].default,s=Pe(t,i,i[8],zs);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&260)&&Te(s,t,r,r[8],e?Ce(t,r[8],n,Zn):Ee(r[8]),zs)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function ti(i){let e,t,s,r;const n=[ei,xn],o=[];function a(l,c){return l[1]?0:1}return e=a(i),t=o[e]=n[e](i),{c(){t.c(),s=le()},l(l){t.l(l),s=le()},m(l,c){o[e].m(l,c),$(l,s,c),r=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(oe(),g(o[u],1,1,()=>{o[u]=null}),ae(),t=o[e],t?t.p(l,c):(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s))},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),o[e].d(l)}}}function si(i,e,t){let s;const r=["orientation","decorative","asChild","el"];let n=$e(e,r),o,{$$slots:a={},$$scope:l}=e,{orientation:c="horizontal"}=e,{decorative:u=!0}=e,{asChild:f=!1}=e,{el:h=void 0}=e;const{elements:{root:d},updateOption:p,getAttrs:b}=Yn({orientation:c,decorative:u});ze(i,d,y=>t(7,o=y));const v=b("root");function k(y){Ge[y?"unshift":"push"](()=>{h=y,t(0,h)})}return i.$$set=y=>{e=z(z({},e),he(y)),t(4,n=$e(e,r)),"orientation"in y&&t(5,c=y.orientation),"decorative"in y&&t(6,u=y.decorative),"asChild"in y&&t(1,f=y.asChild),"el"in y&&t(0,h=y.el),"$$scope"in y&&t(8,l=y.$$scope)},i.$$.update=()=>{i.$$.dirty&32&&p("orientation",c),i.$$.dirty&64&&p("decorative",u),i.$$.dirty&128&&t(2,s=o),i.$$.dirty&4&&Object.assign(s,v)},[h,f,s,d,n,c,u,o,l,a,k]}let ri=class extends ge{constructor(e){super(),me(this,e,si,ti,_e,{orientation:5,decorative:6,asChild:1,el:0})}};function xr(){return{NAME:"switch",PARTS:["root","input","thumb"]}}function ni(i){const{NAME:e,PARTS:t}=xr(),s=vs(e,t),r={...Kn(bs(i)),getAttrs:s};return Hr(e,r),{...r,updateOption:ys(r.options)}}function en(){const{NAME:i}=xr();return Dn(i)}function ii(i){let e,t,s,r=[i[2],{name:i[3]},{disabled:i[4]},{required:i[5]},{value:i[1]},i[11]],n={};for(let o=0;o<r.length;o+=1)n=z(n,r[o]);return{c(){e=J("input"),this.h()},l(o){e=G(o,"INPUT",{name:!0}),this.h()},h(){Be(e,n)},m(o,a){$(o,e,a),"value"in n&&(e.value=n.value),e.autofocus&&e.focus(),i[13](e),t||(s=Ft(i[2].action(e)),t=!0)},p(o,[a]){Be(e,n=ke(r,[a&4&&o[2],a&8&&{name:o[3]},a&16&&{disabled:o[4]},a&32&&{required:o[5]},a&2&&e.value!==o[1]&&{value:o[1]},a&2048&&o[11]])),"value"in n&&(e.value=n.value)},i:de,o:de,d(o){o&&m(e),i[13](null),t=!1,s()}}}function oi(i,e,t){let s;const r=["el"];let n=$e(e,r),o,a,l,c,u,{el:f=void 0}=e;const{elements:{input:h},options:{value:d,name:p,disabled:b,required:v}}=en();ze(i,h,y=>t(2,a=y)),ze(i,d,y=>t(12,o=y)),ze(i,p,y=>t(3,l=y)),ze(i,b,y=>t(4,c=y)),ze(i,v,y=>t(5,u=y));function k(y){Ge[y?"unshift":"push"](()=>{f=y,t(0,f)})}return i.$$set=y=>{e=z(z({},e),he(y)),t(11,n=$e(e,r)),"el"in y&&t(0,f=y.el)},i.$$.update=()=>{i.$$.dirty&4096&&t(1,s=o===void 0||o===""?"on":o)},[f,s,a,l,c,u,h,d,p,b,v,n,o,k]}class ai extends ge{constructor(e){super(),me(this,e,oi,ii,_e,{el:0})}}const li=i=>({builder:i&16}),qs=i=>({builder:i[4]}),ci=i=>({builder:i&16}),Fs=i=>({builder:i[4]});function ui(i){let e,t,s,r;const n=i[17].default,o=Pe(n,i,i[16],qs);let a=[i[4],{type:"button"},i[7]],l={};for(let c=0;c<a.length;c+=1)l=z(l,a[c]);return{c(){e=J("button"),o&&o.c(),this.h()},l(c){e=G(c,"BUTTON",{type:!0});var u=te(e);o&&o.l(u),u.forEach(m),this.h()},h(){Be(e,l)},m(c,u){$(c,e,u),o&&o.m(e,null),e.autofocus&&e.focus(),i[18](e),t=!0,s||(r=[Ft(i[4].action(e)),Nt(e,"m-click",i[6]),Nt(e,"m-keydown",i[6])],s=!0)},p(c,u){o&&o.p&&(!t||u&65552)&&Te(o,n,c,c[16],t?Ce(n,c[16],u,li):Ee(c[16]),qs),Be(e,l=ke(a,[u&16&&c[4],{type:"button"},u&128&&c[7]]))},i(c){t||(_(o,c),t=!0)},o(c){g(o,c),t=!1},d(c){c&&m(e),o&&o.d(c),i[18](null),s=!1,Vr(r)}}}function fi(i){let e;const t=i[17].default,s=Pe(t,i,i[16],Fs);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&65552)&&Te(s,t,r,r[16],e?Ce(t,r[16],n,ci):Ee(r[16]),Fs)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Hs(i){let e,t;const s=[i[3]];let r={};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new ai({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,o){const a=o&8?ke(s,[Le(n[3])]):{};e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function hi(i){let e,t,s,r,n;const o=[fi,ui],a=[];function l(u,f){return u[2]?0:1}e=l(i),t=a[e]=o[e](i);let c=i[1]&&Hs(i);return{c(){t.c(),s=F(),c&&c.c(),r=le()},l(u){t.l(u),s=H(u),c&&c.l(u),r=le()},m(u,f){a[e].m(u,f),$(u,s,f),c&&c.m(u,f),$(u,r,f),n=!0},p(u,[f]){let h=e;e=l(u),e===h?a[e].p(u,f):(oe(),g(a[h],1,1,()=>{a[h]=null}),ae(),t=a[e],t?t.p(u,f):(t=a[e]=o[e](u),t.c()),_(t,1),t.m(s.parentNode,s)),u[1]?c?(c.p(u,f),f&2&&_(c,1)):(c=Hs(u),c.c(),_(c,1),c.m(r.parentNode,r)):c&&(oe(),g(c,1,1,()=>{c=null}),ae())},i(u){n||(_(t),_(c),n=!0)},o(u){g(t),g(c),n=!1},d(u){u&&(m(s),m(r)),a[e].d(u),c&&c.d(u)}}}function di(i,e,t){let s,r;const n=["checked","onCheckedChange","disabled","name","value","includeInput","required","asChild","inputAttrs","el"];let o=$e(e,n),a,{$$slots:l={},$$scope:c}=e,{checked:u=void 0}=e,{onCheckedChange:f=void 0}=e,{disabled:h=void 0}=e,{name:d=void 0}=e,{value:p=void 0}=e,{includeInput:b=!0}=e,{required:v=void 0}=e,{asChild:k=!1}=e,{inputAttrs:y=void 0}=e,{el:V=void 0}=e;const{elements:{root:x},states:{checked:S},updateOption:W,getAttrs:fe}=ni({disabled:h,name:d,value:p,required:v,defaultChecked:u,onCheckedChange:({next:R})=>(u!==R&&(f==null||f(R),t(8,u=R)),R)});ze(i,x,R=>t(15,a=R));const ee=Xr();function Q(R){Ge[R?"unshift":"push"](()=>{V=R,t(0,V)})}return i.$$set=R=>{e=z(z({},e),he(R)),t(7,o=$e(e,n)),"checked"in R&&t(8,u=R.checked),"onCheckedChange"in R&&t(9,f=R.onCheckedChange),"disabled"in R&&t(10,h=R.disabled),"name"in R&&t(11,d=R.name),"value"in R&&t(12,p=R.value),"includeInput"in R&&t(1,b=R.includeInput),"required"in R&&t(13,v=R.required),"asChild"in R&&t(2,k=R.asChild),"inputAttrs"in R&&t(3,y=R.inputAttrs),"el"in R&&t(0,V=R.el),"$$scope"in R&&t(16,c=R.$$scope)},i.$$.update=()=>{i.$$.dirty&256&&u!==void 0&&S.set(u),i.$$.dirty&1024&&W("disabled",h),i.$$.dirty&2048&&W("name",d),i.$$.dirty&4096&&W("value",p),i.$$.dirty&8192&&W("required",v),i.$$.dirty&32768&&t(4,s=a),i.$$.dirty&256&&t(14,r={...fe("root"),"data-checked":u?"":void 0}),i.$$.dirty&16400&&Object.assign(s,r)},[V,b,k,y,s,x,ee,o,u,f,h,d,p,v,r,a,c,l,Q]}let _i=class extends ge{constructor(e){super(),me(this,e,di,hi,_e,{checked:8,onCheckedChange:9,disabled:10,name:11,value:12,includeInput:1,required:13,asChild:2,inputAttrs:3,el:0})}};const gi=i=>({attrs:i&8,checked:i&4}),Vs=i=>({attrs:i[3],checked:i[2]});function mi(i){let e,t=[i[5],i[3]],s={};for(let r=0;r<t.length;r+=1)s=z(s,t[r]);return{c(){e=J("span"),this.h()},l(r){e=G(r,"SPAN",{}),te(e).forEach(m),this.h()},h(){Be(e,s)},m(r,n){$(r,e,n),i[8](e)},p(r,n){Be(e,s=ke(t,[n&32&&r[5],n&8&&r[3]]))},i:de,o:de,d(r){r&&m(e),i[8](null)}}}function pi(i){let e;const t=i[7].default,s=Pe(t,i,i[6],Vs);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&76)&&Te(s,t,r,r[6],e?Ce(t,r[6],n,gi):Ee(r[6]),Vs)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function vi(i){let e,t,s,r;const n=[pi,mi],o=[];function a(l,c){return l[1]?0:1}return e=a(i),t=o[e]=n[e](i),{c(){t.c(),s=le()},l(l){t.l(l),s=le()},m(l,c){o[e].m(l,c),$(l,s,c),r=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(oe(),g(o[u],1,1,()=>{o[u]=null}),ae(),t=o[e],t?t.p(l,c):(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s))},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),o[e].d(l)}}}function bi(i,e,t){let s;const r=["asChild","el"];let n=$e(e,r),o,{$$slots:a={},$$scope:l}=e,{asChild:c=!1}=e,{el:u=void 0}=e;const{states:{checked:f},getAttrs:h}=en();ze(i,f,p=>t(2,o=p));function d(p){Ge[p?"unshift":"push"](()=>{u=p,t(0,u)})}return i.$$set=p=>{e=z(z({},e),he(p)),t(5,n=$e(e,r)),"asChild"in p&&t(1,c=p.asChild),"el"in p&&t(0,u=p.el),"$$scope"in p&&t(6,l=p.$$scope)},i.$$.update=()=>{i.$$.dirty&4&&t(3,s={...h("thumb"),"data-state":o?"checked":"unchecked","data-checked":o?"":void 0})},[u,c,o,s,f,n,l,a,d]}class yi extends ge{constructor(e){super(),me(this,e,bi,vi,_e,{asChild:1,el:0})}}function wi(){return{NAME:"toggle",PARTS:["root","input"]}}function $i(i){const{NAME:e,PARTS:t}=wi(),s=vs(e,t),r={...Qn(bs(i)),getAttrs:s};return Hr(e,r),{...r,updateOption:ys(r.options)}}const ki=i=>({builder:i&4}),Js=i=>({builder:i[2]}),Si=i=>({builder:i&4}),Gs=i=>({builder:i[2]});function Pi(i){let e,t,s,r;const n=i[11].default,o=Pe(n,i,i[10],Js);let a=[i[2],{type:"button"},i[5]],l={};for(let c=0;c<a.length;c+=1)l=z(l,a[c]);return{c(){e=J("button"),o&&o.c(),this.h()},l(c){e=G(c,"BUTTON",{type:!0});var u=te(e);o&&o.l(u),u.forEach(m),this.h()},h(){Be(e,l)},m(c,u){$(c,e,u),o&&o.m(e,null),e.autofocus&&e.focus(),i[12](e),t=!0,s||(r=[Ft(i[2].action(e)),Nt(e,"m-click",i[4]),Nt(e,"m-keydown",i[4])],s=!0)},p(c,u){o&&o.p&&(!t||u&1028)&&Te(o,n,c,c[10],t?Ce(n,c[10],u,ki):Ee(c[10]),Js),Be(e,l=ke(a,[u&4&&c[2],{type:"button"},u&32&&c[5]]))},i(c){t||(_(o,c),t=!0)},o(c){g(o,c),t=!1},d(c){c&&m(e),o&&o.d(c),i[12](null),s=!1,Vr(r)}}}function Ti(i){let e;const t=i[11].default,s=Pe(t,i,i[10],Gs);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&1028)&&Te(s,t,r,r[10],e?Ce(t,r[10],n,Si):Ee(r[10]),Gs)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Ei(i){let e,t,s,r;const n=[Ti,Pi],o=[];function a(l,c){return l[1]?0:1}return e=a(i),t=o[e]=n[e](i),{c(){t.c(),s=le()},l(l){t.l(l),s=le()},m(l,c){o[e].m(l,c),$(l,s,c),r=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(oe(),g(o[u],1,1,()=>{o[u]=null}),ae(),t=o[e],t?t.p(l,c):(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s))},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),o[e].d(l)}}}function Ci(i,e,t){let s;const r=["disabled","pressed","onPressedChange","asChild","el"];let n=$e(e,r),o,{$$slots:a={},$$scope:l}=e,{disabled:c=void 0}=e,{pressed:u=void 0}=e,{onPressedChange:f=void 0}=e,{asChild:h=!1}=e,{el:d=void 0}=e;const{elements:{root:p},states:{pressed:b},updateOption:v,getAttrs:k}=$i({disabled:c,defaultPressed:u,onPressedChange:({next:S})=>(u!==S&&(f==null||f(S),t(6,u=S)),S)});ze(i,p,S=>t(9,o=S));const y=Xr(),V=k("root");function x(S){Ge[S?"unshift":"push"](()=>{d=S,t(0,d)})}return i.$$set=S=>{e=z(z({},e),he(S)),t(5,n=$e(e,r)),"disabled"in S&&t(7,c=S.disabled),"pressed"in S&&t(6,u=S.pressed),"onPressedChange"in S&&t(8,f=S.onPressedChange),"asChild"in S&&t(1,h=S.asChild),"el"in S&&t(0,d=S.el),"$$scope"in S&&t(10,l=S.$$scope)},i.$$.update=()=>{i.$$.dirty&64&&u!==void 0&&b.set(u),i.$$.dirty&128&&v("disabled",c),i.$$.dirty&512&&t(2,s=o),i.$$.dirty&4&&Object.assign(s,V)},[d,h,s,p,y,n,u,c,f,o,l,a,x]}let Oi=class extends ge{constructor(e){super(),me(this,e,Ci,Ei,_e,{disabled:7,pressed:6,onPressedChange:8,asChild:1,el:0})}};function Ai(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function ji(i){let e,t;const s=[{name:"briefcase-medical"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[Ai]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Ri(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["path",{d:"M12 11v4"}],["path",{d:"M14 13h-4"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"}],["path",{d:"M18 6v14"}],["path",{d:"M6 6v14"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class tn extends ge{constructor(e){super(),me(this,e,Ri,ji,_e,{})}}function Ii(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Li(i){let e,t;const s=[{name:"circle-check"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[Ii]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Di(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m9 12 2 2 4-4"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class Ni extends ge{constructor(e){super(),me(this,e,Di,Li,_e,{})}}function Ui(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Mi(i){let e,t;const s=[{name:"circle-x"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[Ui]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Bi(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m15 9-6 6"}],["path",{d:"m9 9 6 6"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class zi extends ge{constructor(e){super(),me(this,e,Bi,Mi,_e,{})}}function qi(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Fi(i){let e,t;const s=[{name:"eye"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[qi]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Hi(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class Vi extends ge{constructor(e){super(),me(this,e,Hi,Fi,_e,{})}}function Ji(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Gi(i){let e,t;const s=[{name:"locate"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[Ji]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Ki(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["line",{x1:"2",x2:"5",y1:"12",y2:"12"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}],["circle",{cx:"12",cy:"12",r:"7"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class Wi extends ge{constructor(e){super(),me(this,e,Ki,Gi,_e,{})}}function Qi(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function Xi(i){let e,t;const s=[{name:"shield-check"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[Qi]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Yi(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],["path",{d:"m9 12 2 2 4-4"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class sn extends ge{constructor(e){super(),me(this,e,Yi,Xi,_e,{})}}function Zi(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function xi(i){let e,t;const s=[{name:"skull"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[Zi]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function eo(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["path",{d:"m12.5 17-.5-1-.5 1h1z"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"9",cy:"12",r:"1"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class rn extends ge{constructor(e){super(),me(this,e,eo,xi,_e,{})}}function to(i){let e;const t=i[2].default,s=Pe(t,i,i[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&8)&&Te(s,t,r,r[3],e?Ce(t,r[3],n,null):Ee(r[3]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function so(i){let e,t;const s=[{name:"thumbs-down"},i[1],{iconNode:i[0]}];let r={$$slots:{default:[to]},$$scope:{ctx:i}};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new Ke({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&3?ke(s,[s[0],o&2&&Le(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function ro(i,e,t){let{$$slots:s={},$$scope:r}=e;const n=[["path",{d:"M17 14V2"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z"}]];return i.$$set=o=>{t(1,e=z(z({},e),he(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=he(e),[n,e,s,r]}class no extends ge{constructor(e){super(),me(this,e,ro,so,_e,{})}}function io(i,e){throw new On(i,e.toString())}new TextEncoder;function oo({url:i}){let e=i.searchParams.get("id"),t=i.searchParams.get("type"),s=localStorage.getItem("username");if(e&&t&&s)return{gameId:e,gameType:t,username:s};!e&&Se.error("Please Enter Room ID"),io(303,"./")}const Xc=Object.freeze(Object.defineProperty({__proto__:null,load:oo},Symbol.toStringTag,{value:"Module"})),ao=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>lt(async()=>{const{default:s}=await Promise.resolve().then(()=>_t);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Es extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class lo extends Es{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class co extends Es{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class uo extends Es{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var as;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(as||(as={}));var fo=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};class ho{constructor(e,{headers:t={},customFetch:s,region:r=as.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=ao(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return fo(this,void 0,void 0,function*(){try{const{headers:r,method:n,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),r),body:c}).catch(p=>{throw new lo(p)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new co(u);if(!u.ok)throw new uo(u);let h=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),d;return h==="application/json"?d=yield u.json():h==="application/octet-stream"?d=yield u.blob():h==="text/event-stream"?d=u:h==="multipart/form-data"?d=yield u.formData():d=yield u.text(),{data:d,error:null}}catch(r){return{data:null,error:r}}})}}var Ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yc(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function _o(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var r=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return i[s]}})}),t}var Re={},Cs={},Vt={},Ct={},Jt={},Gt={},go=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ft=go();const mo=ft.fetch,nn=ft.fetch.bind(ft),on=ft.Headers,po=ft.Request,vo=ft.Response,_t=Object.freeze(Object.defineProperty({__proto__:null,Headers:on,Request:po,Response:vo,default:nn,fetch:mo},Symbol.toStringTag,{value:"Module"})),bo=_o(_t);var Os={};Object.defineProperty(Os,"__esModule",{value:!0});class yo extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}Os.default=yo;var an=Ie&&Ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Gt,"__esModule",{value:!0});const wo=an(bo),$o=an(Os);let ko=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=wo.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async n=>{var o,a,l;let c=null,u=null,f=null,h=n.status,d=n.statusText;if(n.ok){if(this.method!=="HEAD"){const k=await n.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=k:u=JSON.parse(k))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=n.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");b&&v&&v.length>1&&(f=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,h=406,d="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const b=await n.text();try{c=JSON.parse(b),Array.isArray(c)&&n.status===404&&(u=[],c=null,h=200,d="OK")}catch{n.status===404&&b===""?(h=204,d="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,d="OK"),c&&this.shouldThrowOnError)throw new $o.default(c)}return{error:c,data:u,count:f,status:h,statusText:d}});return this.shouldThrowOnError||(r=r.catch(n=>{var o,a,l;return{error:{message:`${(o=n==null?void 0:n.name)!==null&&o!==void 0?o:"FetchError"}: ${n==null?void 0:n.message}`,details:`${(a=n==null?void 0:n.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=n==null?void 0:n.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}};Gt.default=ko;var So=Ie&&Ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Jt,"__esModule",{value:!0});const Po=So(Gt);let To=class extends Po.default{select(e){let t=!1;const s=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:n=r}={}){const o=n?`${n}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const n=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:n=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Jt.default=To;var Eo=Ie&&Ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ct,"__esModule",{value:!0});const Co=Eo(Jt);let Oo=class extends Co.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let n="";r==="plain"?n="pl":r==="phrase"?n="ph":r==="websearch"&&(n="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${n}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Ct.default=Oo;var Ao=Ie&&Ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Vt,"__esModule",{value:!0});const vt=Ao(Ct);let jo=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let n=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new vt.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),s||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new vt.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){const o="POST",a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new vt.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new vt.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new vt.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Vt.default=jo;var Kt={},Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.version=void 0;Wt.version="0.0.0-automated";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.DEFAULT_HEADERS=void 0;const Ro=Wt;Kt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ro.version}`};var ln=Ie&&Ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Cs,"__esModule",{value:!0});const Io=ln(Vt),Lo=ln(Ct),Do=Kt;let No=class cn{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Do.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Io.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new cn(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:n}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;s||r?(o=s?"HEAD":"GET",Object.entries(t).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{a.searchParams.append(u,f)})):(o="POST",l=t);const c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new Lo.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Cs.default=No;var Ot=Ie&&Ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Re,"__esModule",{value:!0});Re.PostgrestBuilder=Re.PostgrestTransformBuilder=Re.PostgrestFilterBuilder=Re.PostgrestQueryBuilder=Re.PostgrestClient=void 0;const un=Ot(Cs);Re.PostgrestClient=un.default;const fn=Ot(Vt);Re.PostgrestQueryBuilder=fn.default;const hn=Ot(Ct);Re.PostgrestFilterBuilder=hn.default;const dn=Ot(Jt);Re.PostgrestTransformBuilder=dn.default;const _n=Ot(Gt);Re.PostgrestBuilder=_n.default;var Uo=Re.default={PostgrestClient:un.default,PostgrestQueryBuilder:fn.default,PostgrestFilterBuilder:hn.default,PostgrestTransformBuilder:dn.default,PostgrestBuilder:_n.default};const{PostgrestClient:Mo,PostgrestQueryBuilder:su,PostgrestFilterBuilder:ru,PostgrestTransformBuilder:nu,PostgrestBuilder:iu}=Uo,Bo="2.10.2",zo={"X-Client-Info":`realtime-js/${Bo}`},qo="1.0.0",gn=1e4,Fo=1e3;var ot;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(ot||(ot={}));var je;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(je||(je={}));var Ue;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(Ue||(Ue={}));var ls;(function(i){i.websocket="websocket"})(ls||(ls={}));var Ze;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ze||(Ze={}));class Ho{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),n=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+r));o=o+r;const l=s.decode(e.slice(o,o+n));o=o+n;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class mn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ue;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(ue||(ue={}));const Ks=(i,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((n,o)=>(n[o]=Vo(o,i,e,r),n),{})},Vo=(i,e,t,s)=>{const r=e.find(a=>a.name===i),n=r==null?void 0:r.type,o=t[i];return n&&!s.includes(n)?pn(n,o):cs(o)},pn=(i,e)=>{if(i.charAt(0)==="_"){const t=i.slice(1,i.length);return Wo(e,t)}switch(i){case ue.bool:return Jo(e);case ue.float4:case ue.float8:case ue.int2:case ue.int4:case ue.int8:case ue.numeric:case ue.oid:return Go(e);case ue.json:case ue.jsonb:return Ko(e);case ue.timestamp:return Qo(e);case ue.abstime:case ue.date:case ue.daterange:case ue.int4range:case ue.int8range:case ue.money:case ue.reltime:case ue.text:case ue.time:case ue.timestamptz:case ue.timetz:case ue.tsrange:case ue.tstzrange:return cs(e);default:return cs(e)}},cs=i=>i,Jo=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Go=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},Ko=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Wo=(i,e)=>{if(typeof i!="string")return i;const t=i.length-1,s=i[t];if(i[0]==="{"&&s==="}"){let n;const o=i.slice(1,t);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(a=>pn(e,a))}return i},Qo=i=>typeof i=="string"?i.replace(" ","T"):i,vn=i=>{let e=i;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class xt{constructor(e,t,s={},r=gn){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ws;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Ws||(Ws={}));class $t{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:n,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$t.syncState(this.state,r,n,o),this.pendingDiffs.forEach(l=>{this.state=$t.syncDiff(this.state,l,n,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},r=>{const{onJoin:n,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=$t.syncDiff(this.state,r,n,o),a())}),this.onJoin((r,n,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:n,newPresences:o})}),this.onLeave((r,n,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const n=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(n,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const f=n[c];if(f){const h=u.map(v=>v.presence_ref),d=f.map(v=>v.presence_ref),p=u.filter(v=>d.indexOf(v.presence_ref)<0),b=f.filter(v=>h.indexOf(v.presence_ref)<0);p.length>0&&(a[c]=p),b.length>0&&(l[c]=b)}else a[c]=u}),this.syncDiff(n,{joins:a,leaves:l},s,r)}static syncDiff(e,t,s,r){const{joins:n,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(n,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const f=e[a].map(d=>d.presence_ref),h=u.filter(d=>f.indexOf(d.presence_ref)<0);e[a].unshift(...h)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),e[a]=c,r(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qs;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Qs||(Qs={}));var Xs;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(Xs||(Xs={}));var Ys;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Ys||(Ys={}));class As{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=je.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new xt(this,Ue.join,this.params,this.timeout),this.rejoinTimer=new mn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=je.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=je.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ue.reply,{},(r,n)=>{this._trigger(this._replyEventName(n),r)}),this.presence=new $t(this),this.broadcastEndpointURL=vn(this.socket.endPoint)+"/api/broadcast"}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:n,presence:o,private:a}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},c={broadcast:n,presence:o,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&r!==void 0?r:[],private:a};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:u})=>{var f;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(f=h==null?void 0:h.length)!==null&&f!==void 0?f:0,p=[];for(let b=0;b<d;b++){const v=h[b],{filter:{event:k,schema:y,table:V,filter:x}}=v,S=u&&u[b];if(S&&S.event===k&&S.schema===y&&S.table===V&&S.filter===x)p.push(Object.assign(Object.assign({},v),{id:S.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:n,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:o}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=l.body)===null||r===void 0?void 0:r.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(n=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&n("ok"),c.receive("ok",()=>n("ok")),c.receive("error",()=>n("error")),c.receive("timeout",()=>n("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=je.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ue.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const r=new xt(this,Ue.leave,{},e);r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const r=new AbortController,n=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(n),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new xt(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,n;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Ue;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let h=this._onMessage(o,t,s);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(d=>{var p,b,v;return((p=d.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(b=d.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(d=>d.callback(h,s)):(n=this.bindings[o])===null||n===void 0||n.filter(d=>{var p,b,v,k,y,V;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in d){const x=d.id,S=(p=d.filter)===null||p===void 0?void 0:p.event;return x&&((b=t.ids)===null||b===void 0?void 0:b.includes(x))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const x=(y=(k=d==null?void 0:d.filter)===null||k===void 0?void 0:k.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return x==="*"||x===((V=t==null?void 0:t.event)===null||V===void 0?void 0:V.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===o}).map(d=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:b,table:v,commit_timestamp:k,type:y,errors:V}=p;h=Object.assign(Object.assign({},{schema:b,table:v,commit_timestamp:k,eventType:y,new:{},old:{},errors:V}),this._getPayloadRecords(p))}d.callback(h,s)})}_isClosed(){return this.state===je.closed}_isJoined(){return this.state===je.joined}_isJoining(){return this.state===je.joining}_isLeaving(){return this.state===je.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),n={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(n):this.bindings[r]=[n],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var n;return!(((n=r.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===s&&As.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ue.close,{},e)}_onError(e){this._on(Ue.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=je.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ks(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ks(e.columns,e.old_record)),t}}const Xo=()=>{},Yo=typeof WebSocket<"u";class Zo{constructor(e,t){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=zo,this.params={},this.timeout=gn,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Xo,this.conn=null,this.sendBuffer=[],this.serializer=new Ho,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...a)=>lt(async()=>{const{default:l}=await Promise.resolve().then(()=>_t);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${ls.websocket}`,this.httpEndpoint=vn(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(n,o)=>o(JSON.stringify(n)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new mn(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Yo){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new xo(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),lt(async()=>{const{default:e}=await import("./browser.CFvjvP1o.js").then(t=>t.b);return{default:e}},[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ot.connecting:return Ze.Connecting;case ot.open:return Ze.Open;case ot.closing:return Ze.Closing;default:return Ze.Closed}}isConnected(){return this.connectionState()===Ze.Open}channel(e,t={config:{}}){const s=new As(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:n}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${s} (${n})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(Ue.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:qo}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:r,payload:n,ref:o}=t;(o&&o===this.pendingHeartbeatRef||r===(n==null?void 0:n.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${s} ${r} ${o&&"("+o+")"||""}`,n),this.channels.filter(a=>a._isMember(s)).forEach(a=>a._trigger(r,n,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ue.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Fo,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class xo{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ot.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class js extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function we(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class ea extends js{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class us extends js{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ta=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};const bn=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>lt(async()=>{const{default:s}=await Promise.resolve().then(()=>_t);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},sa=()=>ta(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield lt(()=>Promise.resolve().then(()=>_t),void 0,import.meta.url)).Response:Response}),fs=i=>{if(Array.isArray(i))return i.map(t=>fs(t));if(typeof i=="function"||i!==Object(i))return i;const e={};return Object.entries(i).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));e[r]=fs(s)}),e};var xe=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};const es=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),ra=(i,e,t)=>xe(void 0,void 0,void 0,function*(){const s=yield sa();i instanceof s&&!(t!=null&&t.noResolveJson)?i.json().then(r=>{e(new ea(es(r),i.status||500))}).catch(r=>{e(new us(es(r),r))}):e(new us(es(i),i))}),na=(i,e,t,s)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(r.body=JSON.stringify(s)),Object.assign(Object.assign({},r),t))};function At(i,e,t,s,r,n){return xe(this,void 0,void 0,function*(){return new Promise((o,a)=>{i(t,na(e,s,r,n)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>ra(l,a,s))})})}function zt(i,e,t,s){return xe(this,void 0,void 0,function*(){return At(i,"GET",e,t,s)})}function He(i,e,t,s,r){return xe(this,void 0,void 0,function*(){return At(i,"POST",e,s,r,t)})}function ia(i,e,t,s,r){return xe(this,void 0,void 0,function*(){return At(i,"PUT",e,s,r,t)})}function oa(i,e,t,s){return xe(this,void 0,void 0,function*(){return At(i,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function yn(i,e,t,s,r){return xe(this,void 0,void 0,function*(){return At(i,"DELETE",e,s,r,t)})}var Ae=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};const aa={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class la{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=bn(r)}uploadOrUpdate(e,t,s,r){return Ae(this,void 0,void 0,function*(){try{let n;const o=Object.assign(Object.assign({},Zs),r);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&s instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),n.append("",s),l&&n.append("metadata",this.encodeMetadata(l))):typeof FormData<"u"&&s instanceof FormData?(n=s,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l))):(n=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),r!=null&&r.headers&&(a=Object.assign(Object.assign({},a),r.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:n,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield f.json();return f.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(n){if(we(n))return{data:null,error:n};throw n}})}upload(e,t,s){return Ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return Ae(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),o=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Zs.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),h=yield f.json();return f.ok?{data:{path:n,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(we(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Ae(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const n=yield He(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(this.url+n.url),a=o.searchParams.get("token");if(!a)throw new js("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(we(s))return{data:null,error:s};throw s}})}update(e,t,s){return Ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Ae(this,void 0,void 0,function*(){try{return{data:yield He(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}})}copy(e,t,s){return Ae(this,void 0,void 0,function*(){try{return{data:{path:(yield He(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return Ae(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=yield He(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return Ae(this,void 0,void 0,function*(){try{const r=yield He(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${n}`):null})),error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}})}download(e,t){return Ae(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=n?`?${n}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield zt(this.fetch,`${this.url}/${r}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(we(a))return{data:null,error:a};throw a}})}info(e){return Ae(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield zt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:fs(s),error:null}}catch(s){if(we(s))return{data:null,error:s};throw s}})}exists(e){return Ae(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield oa(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(we(s)&&s instanceof us){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],n=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&r.push(n);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&r.push(l);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${c}`)}}}remove(e){return Ae(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}})}list(e,t,s){return Ae(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},aa),t),{prefix:e||""});return{data:yield He(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ca="2.7.0",ua={"X-Client-Info":`storage-js/${ca}`};var rt=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};class fa{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},ua),t),this.fetch=bn(s)}listBuckets(){return rt(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(we(e))return{data:null,error:e};throw e}})}getBucket(e){return rt(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return rt(this,void 0,void 0,function*(){try{return{data:yield He(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(we(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return rt(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(we(s))return{data:null,error:s};throw s}})}emptyBucket(e){return rt(this,void 0,void 0,function*(){try{return{data:yield He(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}})}deleteBucket(e){return rt(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}})}}class ha extends fa{constructor(e,t={},s){super(e,t,s)}from(e){return new la(this.url,this.headers,e,this.fetch)}}const da="2.45.2";let yt="";typeof Deno<"u"?yt="deno":typeof document<"u"?yt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?yt="react-native":yt="node";const _a={"X-Client-Info":`supabase-js-${yt}/${da}`},ga={headers:_a},ma={schema:"public"},pa={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},va={};var ba=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};const ya=i=>{let e;return i?e=i:typeof fetch>"u"?e=nn:e=fetch,(...t)=>e(...t)},wa=()=>typeof Headers>"u"?on:Headers,$a=(i,e,t)=>{const s=ya(t),r=wa();return(n,o)=>ba(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:i;let c=new r(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",i),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(n,Object.assign(Object.assign({},o),{headers:c}))})};var ka=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};function Sa(i){return i.replace(/\/$/,"")}function Pa(i,e){const{db:t,auth:s,realtime:r,global:n}=i,{db:o,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),s),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},c),n),accessToken:()=>ka(this,void 0,void 0,function*(){return""})};return i.accessToken?u.accessToken=i.accessToken:delete u.accessToken,u}const wn="2.64.4",Ta="http://localhost:9999",Ea="supabase.auth.token",Ca={"X-Client-Info":`gotrue-js/${wn}`},xs=10,hs="X-Supabase-Api-Version",$n={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Oa(i){return Math.round(Date.now()/1e3)+i}function Aa(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const Ne=()=>typeof document<"u",Qe={tested:!1,writable:!1},kt=()=>{if(!Ne())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Qe.tested)return Qe.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Qe.tested=!0,Qe.writable=!0}catch{Qe.tested=!0,Qe.writable=!1}return Qe.writable};function ts(i){const e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,n)=>{e[n]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const kn=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>lt(async()=>{const{default:s}=await Promise.resolve().then(()=>_t);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},ja=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Sn=async(i,e,t)=>{await i.setItem(e,JSON.stringify(t))},It=async(i,e)=>{const t=await i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ss=async(i,e)=>{await i.removeItem(e)};function Ra(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,r,n,o,a,l,c,u=0;for(i=i.replace("-","+").replace("_","/");u<i.length;)o=e.indexOf(i.charAt(u++)),a=e.indexOf(i.charAt(u++)),l=e.indexOf(i.charAt(u++)),c=e.indexOf(i.charAt(u++)),s=o<<2|a>>4,r=(a&15)<<4|l>>2,n=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&r!=0&&(t=t+String.fromCharCode(r)),c!=64&&n!=0&&(t=t+String.fromCharCode(n));return t}class Qt{constructor(){this.promise=new Qt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Qt.promiseConstructor=Promise;function er(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=i.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(Ra(s))}async function Ia(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function La(i,e){return new Promise((s,r)=>{(async()=>{for(let n=0;n<1/0;n++)try{const o=await i(n);if(!e(n,null,o)){s(o);return}}catch(o){if(!e(n,o)){r(o);return}}})()})}function Da(i){return("0"+i.toString(16)).substr(-2)}function Na(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let n=0;n<56;n++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,Da).join("")}async function Ua(i){const t=new TextEncoder().encode(i),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(n=>String.fromCharCode(n)).join("")}function Ma(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ba(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const t=await Ua(i);return Ma(t)}async function nt(i,e,t=!1){const s=Na();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await Sn(i,`${e}-code-verifier`,r);const n=await Ba(s);return[n,s===n?"plain":"s256"]}const za=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function qa(i){const e=i.headers.get(hs);if(!e||!e.match(za))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Rs extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function se(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class Fa extends Rs{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Ha(i){return se(i)&&i.name==="AuthApiError"}class Pn extends Rs{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class et extends Rs{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class Xe extends et{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class rs extends et{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Lt extends et{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Dt extends et{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tr extends et{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ds extends et{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ns(i){return se(i)&&i.name==="AuthRetryableFetchError"}class sr extends et{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var Va=function(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(i);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(i,s[r])&&(t[s[r]]=i[s[r]]);return t};const Ye=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ja=[502,503,504];async function rr(i){var e;if(!ja(i))throw new ds(Ye(i),0);if(Ja.includes(i.status))throw new ds(Ye(i),i.status);let t;try{t=await i.json()}catch(n){throw new Pn(Ye(n),n)}let s;const r=qa(i);if(r&&r.getTime()>=$n["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new sr(Ye(t),i.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0))throw new sr(Ye(t),i.status,t.weak_password.reasons);throw new Fa(Ye(t),i.status||500,s)}const Ga=(i,e,t,s)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function ne(i,e,t,s){var r;const n=Object.assign({},s==null?void 0:s.headers);n[hs]||(n[hs]=$n["2024-01-01"].name),s!=null&&s.jwt&&(n.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Ka(i,e,t+a,{headers:n,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Ka(i,e,t,s,r,n){const o=Ga(e,s,r,n);let a;try{a=await i(t,Object.assign({},o))}catch(l){throw console.error(l),new ds(Ye(l),0)}if(a.ok||await rr(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await rr(l)}}function Fe(i){var e;let t=null;Ya(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=Oa(i.expires_in)));const s=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:s},error:null}}function nr(i){const e=Fe(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Ve(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function Wa(i){return{data:i,error:null}}function Qa(i){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:n}=i,o=Va(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:n},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Xa(i){return i}function Ya(i){return i.access_token&&i.refresh_token&&i.expires_in}var Za=function(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(i);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(i,s[r])&&(t[s[r]]=i[s[r]]);return t};class xa{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=kn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ne(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ve})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Za(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Qa,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(se(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ve})}catch(t){if(se(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,n,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(n=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""},xform:Xa});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);c[`${v}Page`]=b}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(se(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ve})}catch(t){if(se(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ve})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ve})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(se(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}}}const el={getItem:i=>kt()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{kt()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{kt()&&globalThis.localStorage.removeItem(i)}};function ir(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}function tl(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const it={debug:!!(globalThis&&kt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Tn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class sl extends Tn{}async function rl(i,e,t){it.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),it.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){it.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,r.name);try{return await t()}finally{it.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,r.name)}}else{if(e===0)throw it.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new sl(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(it.debug)try{const n=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}tl();const nl={url:Ta,storageKey:Ea,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ca,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},bt=30*1e3,or=3;async function ar(i,e,t){return await t()}class St{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=St.nextInstanceID,St.nextInstanceID+=1,this.instanceID>0&&Ne()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},nl),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new xa({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=kn(r.fetch),this.lock=r.lock||ar,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ne()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=rl:this.lock=ar,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:kt()?this.storage=el:(this.memoryStorage={},this.storage=ir(this.memoryStorage)):(this.memoryStorage={},this.storage=ir(this.memoryStorage)),Ne()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async n=>{this._debug("received broadcast notification from other tab or client",n),await this._notifyAllSubscribers(n.data.event,n.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=Ne()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),(s==null?void 0:s.message)==="Identity is already linked"||(s==null?void 0:s.message)==="Identity is already linked to another user"?{error:s}:(await this._removeSession(),{error:s});const{session:r,redirectType:n}=t;return this._debug("#_initialize()","detected session in URL",r,"redirect type",n),await this._saveSession(r),setTimeout(async()=>{n==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return se(e)?{error:e}:{error:new Pn("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const n=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Fe}),{data:o,error:a}=n;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(se(n))return{data:{user:null,session:null},error:n};throw n}}async signUp(e){var t,s,r;try{let n;if("email"in e){const{email:u,password:f,options:h}=e;let d=null,p=null;this.flowType==="pkce"&&([d,p]=await nt(this.storage,this.storageKey)),n=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:p},xform:Fe})}else if("phone"in e){const{phone:u,password:f,options:h}=e;n=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(r=h==null?void 0:h.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Fe})}else throw new Lt("You must provide either an email or phone number and a password");const{data:o,error:a}=n;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(se(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:o,options:a}=e;t=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:nr})}else if("phone"in e){const{phone:n,password:o,options:a}=e;t=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:nr})}else throw new Lt("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new rs}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(se(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,n;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(n=e.options)===null||n===void 0?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await It(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/"),{data:n,error:o}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Fe});return await ss(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null,redirectType:null},error:new rs}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign(Object.assign({},n),{redirectType:r??null}),error:o})}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:n,nonce:o}=e,a=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:n,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Fe}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new rs}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(se(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,n,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await nt(this.storage,this.storageKey));const{error:f}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Lt("You must provide either an email or phone number.")}catch(a){if(se(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,s;try{let r,n;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,n=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:r,xform:Fe});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let n=null,o=null;return this.flowType==="pkce"&&([n,o]=await nt(this.storage,this.storageKey)),await ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:o}),headers:this.headers,xform:Wa})}catch(n){if(se(n))return{data:null,error:n};throw n}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Xe;const{error:r}=await ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(se(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:n}=e,{error:o}=await ne(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},redirectTo:n==null?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:r,options:n}=e,{data:o,error:a}=await ne(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Lt("You must provide either an email or phone number and a type")}catch(t){if(se(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await It(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ve}):await this._useSession(async t=>{var s,r,n;const{data:o,error:a}=t;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Xe}:await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0,xform:Ve})})}catch(t){if(se(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:n}=s;if(n)throw n;if(!r.session)throw new Xe;const o=r.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await nt(this.storage,this.storageKey));const{data:c,error:u}=await ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ve});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return er(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Xe;const t=Date.now()/1e3;let s=t,r=!0,n=null;const o=er(e.access_token);if(o.exp&&(s=o.exp,r=s<=t),r){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};n=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;n={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(se(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Xe;const{session:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(se(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!Ne())throw new Dt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Dt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new tr("Not a valid PKCE flow url.");const t=ts(window.location.href);if(e){if(!t.code)throw new tr("No code detected.");const{data:y,error:V}=await this._exchangeCodeForSession(t.code);if(V)throw V;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:y.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Dt(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:r,access_token:n,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=t;if(!n||!a||!o||!c)throw new Dt("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(a);let h=u+f;l&&(h=parseInt(l));const d=h-u;d*1e3<=bt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const p=h-f;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,h,u);const{data:b,error:v}=await this._getUser(n);if(v)throw v;const k={provider_token:s,provider_refresh_token:r,access_token:n,expires_in:f,expires_at:h,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:t.type},error:null}}catch(t){if(se(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=ts(window.location.href);return!!(Ne()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=ts(window.location.href),t=await It(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:n}=t;if(n)return{error:n};const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Ha(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ss(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=Aa(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:n},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(n){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await nt(this.storage,this.storageKey,!0));try{return await ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(se(n))return{data:null,error:n};throw n}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async n=>{var o,a,l,c,u;const{data:f,error:h}=n;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ne(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(r)throw r;return Ne()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(se(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:n,error:o}=t;if(o)throw o;return await ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=n.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(se(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await La(async r=>(r>0&&await Ia(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Fe})),(r,n)=>{const o=200*Math.pow(2,r);return n&&ns(n)&&Date.now()+o-s<bt})}catch(s){if(this._debug(t,"error",s),se(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ne()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await It(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<r+xs;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${xs}s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),ns(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Xe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Qt;const{data:n,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!n.session)throw new Xe;await this._saveSession(n.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",n.session);const a={session:n.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(n){if(this._debug(r,"error",n),se(n)){const o={session:null,error:n};return ns(n)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(n),n}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){n.push(l)}});if(await Promise.all(o),n.length>0){for(let a=0;a<n.length;a+=1)console.error(n[a]);throw n[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Sn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ss(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ne()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),bt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/bt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${bt}ms, refresh threshold is ${or} ticks`),r<=or&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Tn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ne()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[n,o]=await nt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(n)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(a.toString())}if(s!=null&&s.queryParams){const n=new URLSearchParams(s.queryParams);r.push(n.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;return n?{data:null,error:n}:await ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(se(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:n,error:o}=t;if(o)return{data:null,error:o};const{data:a,error:l}=await ne(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(!((r=a==null?void 0:a.totp)===null||r===void 0)&&r.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(se(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;if(n)return{data:null,error:n};const{data:o,error:a}=await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(se(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;return n?{data:null,error:n}:await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(se(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(n=>n.factor_type==="totp"&&n.status==="verified");return{data:{all:s,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:n}=e;if(n)return{data:null,error:n};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}St.nextInstanceID=0;const il=St;class ol extends il{constructor(e){super(e)}}var al=function(i,e,t,s){function r(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?n(u.value):r(u.value).then(a,l)}c((s=s.apply(i,e||[])).next())})};class ll{constructor(e,t,s){var r,n,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=Sa(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:ma,realtime:va,auth:Object.assign(Object.assign({},pa),{storageKey:l}),global:ga},u=Pa(s??{},c);this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(n=u.global.headers)!==null&&n!==void 0?n:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=$a(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},u.realtime)),this.rest=new Mo(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new ho(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ha(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return al(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:n,flowType:o,lock:a,debug:l},c,u){var f;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ol({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:(f="Authorization"in this.headers)!==null&&f!==void 0?f:!1})}_initRealtimeClient(e){return new Zo(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const cl=(i,e,t)=>new ll(i,e,t),ul="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRjbnR5ZW1hZGR1ZHpnamZ4cXF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjQ2OTM3ODgsImV4cCI6MjA0MDI2OTc4OH0.99op72OQJTjaewZZ_dJhXpO_k1zFLkiTZHuvBPujMgM",fl="https://tcntyemaddudzgjfxqqx.supabase.co",lr=cl(fl,ul);function hl(i){let e;const t=i[5].default,s=Pe(t,i,i[8],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&256)&&Te(s,t,r,r[8],e?Ce(t,r[8],n,null):Ee(r[8]),null)},i(r){e||(_(s,r),e=!0)},o(r){g(s,r),e=!1},d(r){s&&s.d(r)}}}function dl(i){let e,t,s;const r=[{class:qe(cr({variant:i[2],size:i[3],className:i[1]}))},i[4]];function n(a){i[6](a)}let o={$$slots:{default:[hl]},$$scope:{ctx:i}};for(let a=0;a<r.length;a+=1)o=z(o,r[a]);return i[0]!==void 0&&(o.pressed=i[0]),e=new Oi({props:o}),Ge.push(()=>_s(e,"pressed",n)),e.$on("click",i[7]),{c(){T(e.$$.fragment)},l(a){E(e.$$.fragment,a)},m(a,l){C(e,a,l),s=!0},p(a,[l]){const c=l&30?ke(r,[l&14&&{class:qe(cr({variant:a[2],size:a[3],className:a[1]}))},l&16&&Le(a[4])]):{};l&256&&(c.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,c.pressed=a[0],gs(()=>t=!1)),e.$set(c)},i(a){s||(_(e.$$.fragment,a),s=!0)},o(a){g(e.$$.fragment,a),s=!1},d(a){O(e,a)}}}function _l(i,e,t){const s=["class","variant","size","pressed"];let r=$e(e,s),{$$slots:n={},$$scope:o}=e,{class:a=void 0}=e,{variant:l="default"}=e,{size:c="default"}=e,{pressed:u=void 0}=e;function f(d){u=d,t(0,u)}function h(d){os.call(this,i,d)}return i.$$set=d=>{e=z(z({},e),he(d)),t(4,r=$e(e,s)),"class"in d&&t(1,a=d.class),"variant"in d&&t(2,l=d.variant),"size"in d&&t(3,c=d.size),"pressed"in d&&t(0,u=d.pressed),"$$scope"in d&&t(8,o=d.$$scope)},[u,a,l,c,r,n,f,h,o]}class jt extends ge{constructor(e){super(),me(this,e,_l,dl,_e,{class:1,variant:2,size:3,pressed:0})}}const cr=Wr({base:"ring-offset-background hover:bg-muted hover:text-muted-foreground focus-visible:ring-ring data-[state=on]:bg-accent data-[state=on]:text-accent-foreground inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",variants:{variant:{default:"bg-transparent",outline:"border-input hover:bg-accent hover:text-accent-foreground border bg-transparent"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}});function gl(i){let e,t;const s=[{class:qe("shrink-0 bg-border",i[1]==="horizontal"?"h-[1px] w-full":"min-h-full w-[1px]",i[0])},{orientation:i[1]},{decorative:i[2]},i[3]];let r={};for(let n=0;n<s.length;n+=1)r=z(r,s[n]);return e=new ri({props:r}),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,[o]){const a=o&15?ke(s,[o&3&&{class:qe("shrink-0 bg-border",n[1]==="horizontal"?"h-[1px] w-full":"min-h-full w-[1px]",n[0])},o&2&&{orientation:n[1]},o&4&&{decorative:n[2]},o&8&&Le(n[3])]):{};e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function ml(i,e,t){const s=["class","orientation","decorative"];let r=$e(e,s),{class:n=void 0}=e,{orientation:o="horizontal"}=e,{decorative:a=void 0}=e;return i.$$set=l=>{e=z(z({},e),he(l)),t(3,r=$e(e,s)),"class"in l&&t(0,n=l.class),"orientation"in l&&t(1,o=l.orientation),"decorative"in l&&t(2,a=l.decorative)},[n,o,a,r]}class En extends ge{constructor(e){super(),me(this,e,ml,gl,_e,{class:0,orientation:1,decorative:2})}}function is(i){let e,t,s;const r=i[5].default,n=Pe(r,i,i[4],null);let o=[{href:i[1]},{class:t=qe(ur({variant:i[2],className:i[0]}))},i[3]],a={};for(let l=0;l<o.length;l+=1)a=z(a,o[l]);return{c(){e=J(i[1]?"a":"span"),n&&n.c(),this.h()},l(l){e=G(l,((i[1]?"a":"span")||"null").toUpperCase(),{href:!0,class:!0});var c=te(e);n&&n.l(c),c.forEach(m),this.h()},h(){Us(i[1]?"a":"span")(e,a)},m(l,c){$(l,e,c),n&&n.m(e,null),s=!0},p(l,c){n&&n.p&&(!s||c&16)&&Te(n,r,l,l[4],s?Ce(r,l[4],c,null):Ee(l[4]),null),Us(l[1]?"a":"span")(e,a=ke(o,[(!s||c&2)&&{href:l[1]},(!s||c&5&&t!==(t=qe(ur({variant:l[2],className:l[0]}))))&&{class:t},c&8&&l[3]]))},i(l){s||(_(n,l),s=!0)},o(l){g(n,l),s=!1},d(l){l&&m(e),n&&n.d(l)}}}function pl(i){let e=i[1]?"a":"span",t,s,r=(i[1]?"a":"span")&&is(i);return{c(){r&&r.c(),t=le()},l(n){r&&r.l(n),t=le()},m(n,o){r&&r.m(n,o),$(n,t,o),s=!0},p(n,[o]){n[1],e?_e(e,n[1]?"a":"span")?(r.d(1),r=is(n),e=n[1]?"a":"span",r.c(),r.m(t.parentNode,t)):r.p(n,o):(r=is(n),e=n[1]?"a":"span",r.c(),r.m(t.parentNode,t))},i(n){s||(_(r,n),s=!0)},o(n){g(r,n),s=!1},d(n){n&&m(t),r&&r.d(n)}}}function vl(i,e,t){const s=["class","href","variant"];let r=$e(e,s),{$$slots:n={},$$scope:o}=e,{class:a=void 0}=e,{href:l=void 0}=e,{variant:c="default"}=e;return i.$$set=u=>{e=z(z({},e),he(u)),t(3,r=$e(e,s)),"class"in u&&t(0,a=u.class),"href"in u&&t(1,l=u.href),"variant"in u&&t(2,c=u.variant),"$$scope"in u&&t(4,o=u.$$scope)},[a,l,c,r,o,n]}class tt extends ge{constructor(e){super(),me(this,e,vl,pl,_e,{class:0,href:1,variant:2})}}const ur=Wr({base:"focus:ring-ring inline-flex select-none items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/80 border-transparent",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border-transparent",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80 border-transparent",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function bl(i){let e,t;return e=new yi({props:{class:qe("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p:de,i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function yl(i){let e,t,s;const r=[{class:qe("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",i[1])},i[2]];function n(a){i[3](a)}let o={$$slots:{default:[bl]},$$scope:{ctx:i}};for(let a=0;a<r.length;a+=1)o=z(o,r[a]);return i[0]!==void 0&&(o.checked=i[0]),e=new _i({props:o}),Ge.push(()=>_s(e,"checked",n)),e.$on("click",i[4]),e.$on("keydown",i[5]),{c(){T(e.$$.fragment)},l(a){E(e.$$.fragment,a)},m(a,l){C(e,a,l),s=!0},p(a,[l]){const c=l&6?ke(r,[l&2&&{class:qe("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a[1])},l&4&&Le(a[2])]):{};l&64&&(c.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,c.checked=a[0],gs(()=>t=!1)),e.$set(c)},i(a){s||(_(e.$$.fragment,a),s=!0)},o(a){g(e.$$.fragment,a),s=!1},d(a){O(e,a)}}}function wl(i,e,t){const s=["class","checked"];let r=$e(e,s),{class:n=void 0}=e,{checked:o=void 0}=e;function a(u){o=u,t(0,o)}function l(u){os.call(this,i,u)}function c(u){os.call(this,i,u)}return i.$$set=u=>{e=z(z({},e),he(u)),t(2,r=$e(e,s)),"class"in u&&t(1,n=u.class),"checked"in u&&t(0,o=u.checked)},[o,n,r,a,l,c]}class $l extends ge{constructor(e){super(),me(this,e,wl,yl,_e,{class:1,checked:0})}}function kl(i,{delay:e=0,duration:t=400,easing:s=ms,start:r=0,opacity:n=0}={}){const o=getComputedStyle(i),a=+o.opacity,l=o.transform==="none"?"":o.transform,c=1-r,u=a*(1-n);return{delay:e,duration:t,easing:s,css:(f,h)=>`
			transform: ${l} scale(${1-c*h});
			opacity: ${a-u*h}
		`}}function Sl({fallback:i,...e}){const t=new Map,s=new Map;function r(o,a,l){const{delay:c=0,duration:u=W=>Math.sqrt(W)*30,easing:f=ms}=z(z({},e),l),h=o.getBoundingClientRect(),d=a.getBoundingClientRect(),p=h.left-d.left,b=h.top-d.top,v=h.width/d.width,k=h.height/d.height,y=Math.sqrt(p*p+b*b),V=getComputedStyle(a),x=V.transform==="none"?"":V.transform,S=+V.opacity;return{delay:c,duration:Jr(u)?u(y):u,easing:f,css:(W,fe)=>`
				opacity: ${W*S};
				transform-origin: top left;
				transform: ${x} translate(${fe*p}px,${fe*b}px) scale(${W+(1-W)*v}, ${W+(1-W)*k});
			`}}function n(o,a,l){return(c,u)=>(o.set(u.key,c),()=>{if(a.has(u.key)){const f=a.get(u.key);return a.delete(u.key),r(f,c,u)}return o.delete(u.key),i&&i(c,u,l)})}return[n(s,t,!1),n(t,s,!0)]}function gt(i,{from:e,to:t},s={}){const r=getComputedStyle(i),n=r.transform==="none"?"":r.transform,[o,a]=r.transformOrigin.split(" ").map(parseFloat),l=e.left+e.width*o/t.width-(t.left+o),c=e.top+e.height*a/t.height-(t.top+a),{delay:u=0,duration:f=d=>Math.sqrt(d)*120,easing:h=ms}=s;return{delay:u,duration:Jr(f)?f(Math.sqrt(l*l+c*c)):f,easing:h,css:(d,p)=>{const b=p*l,v=p*c,k=d+p*e.width/t.width,y=d+p*e.height/t.height;return`transform: ${n} translate(${b}px, ${v}px) scale(${k}, ${y});`}}}function fr(i,e,t){const s=i.slice();return s[24]=e[t],s}function hr(i,e,t){const s=i.slice();return s[27]=e[t],s}function dr(i,e,t){const s=i.slice();return s[27]=e[t],s}function _r(i,e,t){const s=i.slice();return s[27]=e[t],s}function Pl(i){let e,t;return{c(){e=Y(i[1]),t=Y(" Time")},l(s){e=Z(s,i[1]),t=Z(s," Time")},m(s,r){$(s,e,r),$(s,t,r)},p(s,r){r[0]&2&&ye(e,s[1])},d(s){s&&(m(e),m(t))}}}function Tl(i){let e=i[1]=="day"?"Vote player off":"Perform your secret role",t;return{c(){t=Y(e)},l(s){t=Z(s,e)},m(s,r){$(s,t,r)},p(s,r){r[0]&2&&e!==(e=s[1]=="day"?"Vote player off":"Perform your secret role")&&ye(t,e)},d(s){s&&m(t)}}}function El(i){let e,t,s,r;return e=new Ps({props:{class:"capitalize",tag:"h1",$$slots:{default:[Pl]},$$scope:{ctx:i}}}),s=new Ts({props:{$$slots:{default:[Tl]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment)},l(n){E(e.$$.fragment,n),t=H(n),E(s.$$.fragment,n)},m(n,o){C(e,n,o),$(n,t,o),C(s,n,o),r=!0},p(n,o){const a={};o[0]&2|o[1]&8&&(a.$$scope={dirty:o,ctx:n}),e.$set(a);const l={};o[0]&2|o[1]&8&&(l.$$scope={dirty:o,ctx:n}),s.$set(l)},i(n){r||(_(e.$$.fragment,n),_(s.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),g(s.$$.fragment,n),r=!1},d(n){n&&m(t),O(e,n),O(s,n)}}}function gr(i){let e,t;return e=new tt({props:{variant:"outline",$$slots:{default:[Cl]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&12|r[1]&8&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Cl(i){let e=i[3][i[24]]+"",t;return{c(){t=Y(e)},l(s){t=Z(s,e)},m(s,r){$(s,t,r)},p(s,r){r[0]&12&&e!==(e=s[3][s[24]]+"")&&ye(t,e)},d(s){s&&m(t)}}}function mr(i){let e,t;return e=new sn({props:{class:"w-8 stroke-purple-500"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function pr(i){let e,t;return e=new rn({props:{class:"w-8"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function vr(i){let e,t;return e=new tn({props:{class:"w-8 stroke-green-500"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function br(i){let e,t;return e=new tt({props:{style:"--my-color:var(--my-color-"+i[10][i[27]]+")",class:"h-3 w-3 border border-primary bg-[var(--my-color)] p-0 hover:bg-[var(--my-color)]"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&3076&&(n.style="--my-color:var(--my-color-"+s[10][s[27]]+")"),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Ol(i){let e,t,s=be(i[11][i[24]]?i[11][i[24]]:[]),r=[];for(let o=0;o<s.length;o+=1)r[o]=br(_r(i,s,o));const n=o=>g(r[o],1,1,()=>{r[o]=null});return{c(){e=J("div");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=G(o,"DIV",{class:!0});var a=te(e);for(let l=0;l<r.length;l+=1)r[l].l(a);a.forEach(m),this.h()},h(){X(e,"class","flex flex-nowrap *:-ml-1 first:*:m-0")},m(o,a){$(o,e,a);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null);t=!0},p(o,a){if(a[0]&3076){s=be(o[11][o[24]]?o[11][o[24]]:[]);let l;for(l=0;l<s.length;l+=1){const c=_r(o,s,l);r[l]?(r[l].p(c,a),_(r[l],1)):(r[l]=br(c),r[l].c(),_(r[l],1),r[l].m(e,null))}for(oe(),l=s.length;l<r.length;l+=1)n(l);ae()}},i(o){if(!t){for(let a=0;a<s.length;a+=1)_(r[a]);t=!0}},o(o){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)g(r[a]);t=!1},d(o){o&&m(e),Ht(r,o)}}}function yr(i){let e,t;return e=new Fn({props:{$$slots:{default:[jl]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&3076|r[1]&8&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Al(i){let e=i[27]+"",t;return{c(){t=Y(e)},l(s){t=Z(s,e)},m(s,r){$(s,t,r)},p(s,r){r[0]&2052&&e!==(e=s[27]+"")&&ye(t,e)},d(s){s&&m(t)}}}function wr(i,e){let t,s,r,n,o,a=de,l;return s=new tt({props:{style:"--my-color:var(--my-color-"+e[10][e[27]]+")",class:"bg-[var(--my-color)] hover:bg-[var(--my-color)]",$$slots:{default:[Al]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=J("div"),T(s.$$.fragment),r=F(),this.h()},l(c){t=G(c,"DIV",{});var u=te(t);E(s.$$.fragment,u),r=H(u),u.forEach(m),this.h()},h(){this.first=t},m(c,u){$(c,t,u),C(s,t,null),I(t,r),l=!0},p(c,u){e=c;const f={};u[0]&3076&&(f.style="--my-color:var(--my-color-"+e[10][e[27]]+")"),u[0]&2052|u[1]&8&&(f.$$scope={dirty:u,ctx:e}),s.$set(f)},r(){o=t.getBoundingClientRect()},f(){dt(t),a()},a(){a(),a=ht(t,o,gt,{duration:600})},i(c){l||(_(s.$$.fragment,c),c&&(n||Tt(()=>{n=Pt(t,kl,{}),n.start()})),l=!0)},o(c){g(s.$$.fragment,c),l=!1},d(c){c&&m(t),O(s)}}}function jl(i){let e,t=[],s=new Map,r,n=be(i[11][i[24]]?i[11][i[24]]:[]);const o=a=>a[27];for(let a=0;a<n.length;a+=1){let l=dr(i,n,a),c=o(l);s.set(c,t[a]=wr(c,l))}return{c(){e=J("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=G(a,"DIV",{class:!0});var l=te(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(m),this.h()},h(){X(e,"class","color-scheme flex flex-wrap justify-evenly gap-1")},m(a,l){$(a,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);r=!0},p(a,l){if(l[0]&3076){n=be(a[11][a[24]]?a[11][a[24]]:[]),oe();for(let c=0;c<t.length;c+=1)t[c].r();t=ct(t,l,o,1,a,n,s,e,ut,wr,null,dr);for(let c=0;c<t.length;c+=1)t[c].a();ae()}},i(a){if(!r){for(let l=0;l<n.length;l+=1)_(t[l]);r=!0}},o(a){for(let l=0;l<t.length;l+=1)g(t[l]);r=!1},d(a){a&&m(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function Rl(i){let e,t,s,r;e=new qn({props:{class:"h-10 px-2",$$slots:{default:[Ol]},$$scope:{ctx:i}}});let n=i[11][i[24]]&&i[11][i[24]].length>0&&yr(i);return{c(){T(e.$$.fragment),t=F(),n&&n.c(),s=le()},l(o){E(e.$$.fragment,o),t=H(o),n&&n.l(o),s=le()},m(o,a){C(e,o,a),$(o,t,a),n&&n.m(o,a),$(o,s,a),r=!0},p(o,a){const l={};a[0]&3076|a[1]&8&&(l.$$scope={dirty:a,ctx:o}),e.$set(l),o[11][o[24]]&&o[11][o[24]].length>0?n?(n.p(o,a),a[0]&2052&&_(n,1)):(n=yr(o),n.c(),_(n,1),n.m(s.parentNode,s)):n&&(oe(),g(n,1,1,()=>{n=null}),ae())},i(o){r||(_(e.$$.fragment,o),_(n),r=!0)},o(o){g(e.$$.fragment,o),g(n),r=!1},d(o){o&&(m(t),m(s)),O(e,o),n&&n.d(o)}}}function Il(i){var r;let e,t;function s(){return i[21](i[24])}return e=new Je({props:{variant:"secondary",class:"group justify-self-end",disabled:!((r=i[0][i[4]])!=null&&r.isAlive)||!i[0][i[24]].isAlive||!i[12],$$slots:{default:[Dl]},$$scope:{ctx:i}}}),e.$on("click",s),{c(){T(e.$$.fragment)},l(n){E(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,o){var l;i=n;const a={};o[0]&21&&(a.disabled=!((l=i[0][i[4]])!=null&&l.isAlive)||!i[0][i[24]].isAlive||!i[12]),o[1]&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Ll(i){var r,n;let e,t;function s(...o){return i[20](i[24],...o)}return e=new jt({props:{class:"group justify-self-end",pressed:i[5]==i[24],onPressedChange:s,disabled:!((r=i[0][i[4]])!=null&&r.isAlive)||!((n=i[0][i[24]])!=null&&n.isAlive)||!i[12],$$slots:{default:[Nl]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(o){E(e.$$.fragment,o)},m(o,a){C(e,o,a),t=!0},p(o,a){var c,u;i=o;const l={};a[0]&36&&(l.pressed=i[5]==i[24]),a[0]&4&&(l.onPressedChange=s),a[0]&21&&(l.disabled=!((c=i[0][i[4]])!=null&&c.isAlive)||!((u=i[0][i[24]])!=null&&u.isAlive)||!i[12]),a[1]&8&&(l.$$scope={dirty:a,ctx:i}),e.$set(l)},i(o){t||(_(e.$$.fragment,o),t=!0)},o(o){g(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function Dl(i){let e,t;return e=new Wi({props:{size:"20",class:"scale-110 transition duration-300 ease-in-out group-data-[state=on]:scale-125"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p:de,i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Nl(i){let e,t;return e=new no({props:{size:"20",class:"scale-110 transition duration-300 ease-in-out group-data-[state=on]:scale-125"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p:de,i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function $r(i){let e,t,s,r;const n=[zl,Bl,Ml,Ul],o=[];function a(l,c){return l[3][l[4]]=="mafia"?0:l[3][l[4]]=="doctor"&&l[7]==l[24]?1:l[3][l[4]]=="detective"&&l[7]==l[24]?2:l[3][l[4]]=="prostitute"&&l[7]==l[24]?3:-1}return~(t=a(i))&&(s=o[t]=n[t](i)),{c(){e=J("div"),s&&s.c(),this.h()},l(l){e=G(l,"DIV",{class:!0});var c=te(e);s&&s.l(c),c.forEach(m),this.h()},h(){X(e,"class","absolute right-full flex h-12 w-5 flex-col justify-center")},m(l,c){$(l,e,c),~t&&o[t].m(e,null),r=!0},p(l,c){let u=t;t=a(l),t===u?~t&&o[t].p(l,c):(s&&(oe(),g(o[u],1,1,()=>{o[u]=null}),ae()),~t?(s=o[t],s?s.p(l,c):(s=o[t]=n[t](l),s.c()),_(s,1),s.m(e,null)):s=null)},i(l){r||(_(s),r=!0)},o(l){g(s),r=!1},d(l){l&&m(e),~t&&o[t].d()}}}function Ul(i){let e,t;return e=new sn({props:{class:"-mt-4 w-4 stroke-purple-500 first:m-0"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p:de,i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Ml(i){let e,t,s,r;const n=[Fl,ql],o=[];function a(l,c){return l[3][l[24]]=="mafia"?0:1}return e=a(i),t=o[e]=n[e](i),{c(){t.c(),s=le()},l(l){t.l(l),s=le()},m(l,c){o[e].m(l,c),$(l,s,c),r=!0},p(l,c){let u=e;e=a(l),e!==u&&(oe(),g(o[u],1,1,()=>{o[u]=null}),ae(),t=o[e],t||(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s))},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),o[e].d(l)}}}function Bl(i){let e,t;return e=new tn({props:{class:"-mt-4 w-4 stroke-green-500 first:m-0"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p:de,i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function zl(i){let e,t,s=be(i[9][i[24]]?i[9][i[24]]:[]),r=[];for(let o=0;o<s.length;o+=1)r[o]=kr(hr(i,s,o));const n=o=>g(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=le()},l(o){for(let a=0;a<r.length;a+=1)r[a].l(o);e=le()},m(o,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(o,a);$(o,e,a),t=!0},p(o,a){if(a[0]&1540){s=be(o[9][o[24]]?o[9][o[24]]:[]);let l;for(l=0;l<s.length;l+=1){const c=hr(o,s,l);r[l]?(r[l].p(c,a),_(r[l],1)):(r[l]=kr(c),r[l].c(),_(r[l],1),r[l].m(e.parentNode,e))}for(oe(),l=s.length;l<r.length;l+=1)n(l);ae()}},i(o){if(!t){for(let a=0;a<s.length;a+=1)_(r[a]);t=!0}},o(o){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)g(r[a]);t=!1},d(o){o&&m(e),Ht(r,o)}}}function ql(i){let e,t;return e=new zi({props:{class:"-mt-4 w-4 stroke-red-500 first:m-0"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Fl(i){let e,t;return e=new Ni({props:{class:"-mt-4 w-4 stroke-green-500 first:m-0"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function kr(i){let e,t;return e=new rn({props:{style:"--my-color:var(--my-color-"+i[10][i[27]]+")",class:"-mt-4 w-4 fill-[var(--my-color)] stroke-card first:m-0"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&1540&&(n.style="--my-color:var(--my-color-"+s[10][s[27]]+")"),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Sr(i,e){let t,s,r,n=e[24]+"",o,a,l,c,u,f,h,d,p,b,v,k,y,V,x,S,W=de,fe,ee=(e[6]&&(e[4]==e[24]||e[3][e[4]]=="mafia"&&e[3][e[24]]=="mafia")||e[8])&&gr(e),Q=e[0][e[24]].isProtected&&mr(),R=e[0][e[24]].isKilled&&pr(),w=e[0][e[24]].isHealed&&vr();p=new zn({props:{$$slots:{default:[Rl]},$$scope:{ctx:e}}});const re=[Ll,Il],P=[];function q(K,N){return K[1]=="day"?0:K[1]=="night"?1:-1}~(v=q(e))&&(k=P[v]=re[v](e));let M=e[6]&&$r(e);return{key:i,first:null,c(){t=J("div"),s=J("div"),r=J("span"),o=Y(n),l=F(),ee&&ee.c(),c=F(),u=J("div"),Q&&Q.c(),f=F(),R&&R.c(),h=F(),w&&w.c(),d=F(),T(p.$$.fragment),b=F(),k&&k.c(),y=F(),M&&M.c(),V=F(),this.h()},l(K){t=G(K,"DIV",{style:!0,class:!0});var N=te(t);s=G(N,"DIV",{class:!0});var pe=te(s);r=G(pe,"SPAN",{class:!0});var ve=te(r);o=Z(ve,n),ve.forEach(m),l=H(pe),ee&&ee.l(pe),pe.forEach(m),c=H(N),u=G(N,"DIV",{class:!0});var ie=te(u);Q&&Q.l(ie),f=H(ie),R&&R.l(ie),h=H(ie),w&&w.l(ie),ie.forEach(m),d=H(N),E(p.$$.fragment,N),b=H(N),k&&k.l(N),y=H(N),M&&M.l(N),V=H(N),N.forEach(m),this.h()},h(){X(r,"class",a=e[0][e[24]].isAlive?"":"line-through"),X(s,"class","col-span-3"),X(u,"class","flex"),Ms(t,"--my-color","var(--my-color-"+e[10][e[24]]+")"),X(t,"class",x=(e[0][e[24]].isAlive&&e[12]?"order-1":"order-2 opacity-50")+" relative grid h-12 w-full grid-cols-6 items-center rounded-sm border border-l-4 border-input border-l-[var(--my-color)] bg-primary-foreground bg-opacity-10 px-3 font-medium ring-offset-background"),this.first=t},m(K,N){$(K,t,N),I(t,s),I(s,r),I(r,o),I(s,l),ee&&ee.m(s,null),I(t,c),I(t,u),Q&&Q.m(u,null),I(u,f),R&&R.m(u,null),I(u,h),w&&w.m(u,null),I(t,d),C(p,t,null),I(t,b),~v&&P[v].m(t,null),I(t,y),M&&M.m(t,null),I(t,V),fe=!0},p(K,N){e=K,(!fe||N[0]&4)&&n!==(n=e[24]+"")&&ye(o,n),(!fe||N[0]&5&&a!==(a=e[0][e[24]].isAlive?"":"line-through"))&&X(r,"class",a),e[6]&&(e[4]==e[24]||e[3][e[4]]=="mafia"&&e[3][e[24]]=="mafia")||e[8]?ee?(ee.p(e,N),N[0]&348&&_(ee,1)):(ee=gr(e),ee.c(),_(ee,1),ee.m(s,null)):ee&&(oe(),g(ee,1,1,()=>{ee=null}),ae()),e[0][e[24]].isProtected?Q?N[0]&5&&_(Q,1):(Q=mr(),Q.c(),_(Q,1),Q.m(u,f)):Q&&(oe(),g(Q,1,1,()=>{Q=null}),ae()),e[0][e[24]].isKilled?R?N[0]&5&&_(R,1):(R=pr(),R.c(),_(R,1),R.m(u,h)):R&&(oe(),g(R,1,1,()=>{R=null}),ae()),e[0][e[24]].isHealed?w?N[0]&5&&_(w,1):(w=vr(),w.c(),_(w,1),w.m(u,null)):w&&(oe(),g(w,1,1,()=>{w=null}),ae());const pe={};N[0]&3076|N[1]&8&&(pe.$$scope={dirty:N,ctx:e}),p.$set(pe);let ve=v;v=q(e),v===ve?~v&&P[v].p(e,N):(k&&(oe(),g(P[ve],1,1,()=>{P[ve]=null}),ae()),~v?(k=P[v],k?k.p(e,N):(k=P[v]=re[v](e),k.c()),_(k,1),k.m(t,y)):k=null),e[6]?M?(M.p(e,N),N[0]&64&&_(M,1)):(M=$r(e),M.c(),_(M,1),M.m(t,V)):M&&(oe(),g(M,1,1,()=>{M=null}),ae()),(!fe||N[0]&1028)&&Ms(t,"--my-color","var(--my-color-"+e[10][e[24]]+")"),(!fe||N[0]&5&&x!==(x=(e[0][e[24]].isAlive&&e[12]?"order-1":"order-2 opacity-50")+" relative grid h-12 w-full grid-cols-6 items-center rounded-sm border border-l-4 border-input border-l-[var(--my-color)] bg-primary-foreground bg-opacity-10 px-3 font-medium ring-offset-background"))&&X(t,"class",x)},r(){S=t.getBoundingClientRect()},f(){dt(t),W()},a(){W(),W=ht(t,S,gt,{})},i(K){fe||(_(ee),_(Q),_(R),_(w),_(p.$$.fragment,K),_(k),_(M),fe=!0)},o(K){g(ee),g(Q),g(R),g(w),g(p.$$.fragment,K),g(k),g(M),fe=!1},d(K){K&&m(t),ee&&ee.d(),Q&&Q.d(),R&&R.d(),w&&w.d(),O(p),~v&&P[v].d(),M&&M.d()}}}function Hl(i){let e,t=[],s=new Map,r,n=be(i[2]);const o=a=>a[24];for(let a=0;a<n.length;a+=1){let l=fr(i,n,a),c=o(l);s.set(c,t[a]=Sr(c,l))}return{c(){e=J("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=G(a,"DIV",{class:!0});var l=te(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(m),this.h()},h(){X(e,"class","flex flex-col gap-2")},m(a,l){$(a,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);r=!0},p(a,l){if(l[0]&57343){n=be(a[2]),oe();for(let c=0;c<t.length;c+=1)t[c].r();t=ct(t,l,o,1,a,n,s,e,ut,Sr,null,fr);for(let c=0;c<t.length;c+=1)t[c].a();ae()}},i(a){if(!r){for(let l=0;l<n.length;l+=1)_(t[l]);r=!0}},o(a){for(let l=0;l<t.length;l+=1)g(t[l]);r=!1},d(a){a&&m(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function Vl(i){let e,t;return e=new Vi({props:{class:i[6]?"":"stroke-muted-foreground"}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&64&&(n.class=s[6]?"":"stroke-muted-foreground"),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Jl(i){let e;return{c(){e=Y("Confirm")},l(t){e=Z(t,"Confirm")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function Gl(i){let e,t,s,r,n,o,a;return t=new $l({props:{id:"reveal",onCheckedChange:i[13],checked:i[6]}}),r=new Yr({props:{for:"reveal",$$slots:{default:[Vl]},$$scope:{ctx:i}}}),o=new Je({props:{$$slots:{default:[Jl]},$$scope:{ctx:i}}}),o.$on("click",i[16]),{c(){e=J("div"),T(t.$$.fragment),s=F(),T(r.$$.fragment),n=F(),T(o.$$.fragment),this.h()},l(l){e=G(l,"DIV",{class:!0});var c=te(e);E(t.$$.fragment,c),s=H(c),E(r.$$.fragment,c),c.forEach(m),n=H(l),E(o.$$.fragment,l),this.h()},h(){X(e,"class","flex gap-2")},m(l,c){$(l,e,c),C(t,e,null),I(e,s),C(r,e,null),$(l,n,c),C(o,l,c),a=!0},p(l,c){const u={};c[0]&64&&(u.checked=l[6]),t.$set(u);const f={};c[0]&64|c[1]&8&&(f.$$scope={dirty:c,ctx:l}),r.$set(f);const h={};c[1]&8&&(h.$$scope={dirty:c,ctx:l}),o.$set(h)},i(l){a||(_(t.$$.fragment,l),_(r.$$.fragment,l),_(o.$$.fragment,l),a=!0)},o(l){g(t.$$.fragment,l),g(r.$$.fragment,l),g(o.$$.fragment,l),a=!1},d(l){l&&(m(e),m(n)),O(t),O(r),O(o,l)}}}function Kl(i){let e,t,s,r,n,o;return e=new $s({props:{$$slots:{default:[El]},$$scope:{ctx:i}}}),s=new ks({props:{$$slots:{default:[Hl]},$$scope:{ctx:i}}}),n=new Ss({props:{class:"flex justify-between",$$slots:{default:[Gl]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment),r=F(),T(n.$$.fragment)},l(a){E(e.$$.fragment,a),t=H(a),E(s.$$.fragment,a),r=H(a),E(n.$$.fragment,a)},m(a,l){C(e,a,l),$(a,t,l),C(s,a,l),$(a,r,l),C(n,a,l),o=!0},p(a,l){const c={};l[0]&2|l[1]&8&&(c.$$scope={dirty:l,ctx:a}),e.$set(c);const u={};l[0]&4095|l[1]&8&&(u.$$scope={dirty:l,ctx:a}),s.$set(u);const f={};l[0]&64|l[1]&8&&(f.$$scope={dirty:l,ctx:a}),n.$set(f)},i(a){o||(_(e.$$.fragment,a),_(s.$$.fragment,a),_(n.$$.fragment,a),o=!0)},o(a){g(e.$$.fragment,a),g(s.$$.fragment,a),g(n.$$.fragment,a),o=!1},d(a){a&&(m(t),m(r)),O(e,a),O(s,a),O(n,a)}}}function Wl(i){let e,t;return e=new ws({props:{class:"color-scheme mx-auto max-w-sm bg-card",$$slots:{default:[Kl]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&4095|r[1]&8&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Ql(i,e,t){let s,r,n,{channel:o}=e,{finalizedPlayers:a}=e,{assignedRoles:l}=e,{gameState:c}=e,{gameTime:u}=e,{username:f}=e;const h=a.some(w=>w==f);let d={},p=!1,b,v=null,k=null,y={},V=!1;o.on("broadcast",{event:"update"},({payload:w})=>{w.votes&&t(18,d=w.votes),w.gameState&&t(0,c=w.gameState),w.gameTime&&t(1,u=w.gameTime),w.proceed&&fe(w.gameTime),w.gameEnded&&t(8,V=w.gameEnded)}),l[f]=="mafia"&&o.on("broadcast",{event:"mafia-communicate"},({payload:w})=>{l[w.key]=="mafia"&&t(19,y[w.key]=w.targetedPlayer,y)});function x(w=!0){t(6,p=w),w&&(b&&clearTimeout(b),b=setTimeout(()=>{t(6,p=!1),clearTimeout(b),b=null},3e3))}function S(w,re){if(c[w].isProtected){t(5,v),Se.warning("The player can not be voted off.");return}re?t(5,v=w):t(5,v=null)}function W(w){switch(x(),l[f]){case"villager":break;case"mafia":if(w==f){Se.message("Cannot act upon self.");break}k!=w&&(t(7,k=w),t(19,y[f]=w,y),o.send({type:"broadcast",event:"action",payload:{key:f,action:"kill",targetedPlayer:k}}),o.send({type:"broadcast",event:"mafia-communicate",payload:{key:f,targetedPlayer:k}}));break;case"doctor":k!=w&&(t(7,k=w),o.send({type:"broadcast",event:"action",payload:{key:f,action:"heal",targetedPlayer:k}}));break;case"prostitute":if(w==f){Se.message("Cannot act upon self.");break}k!=w&&(t(7,k=w),o.send({type:"broadcast",event:"action",payload:{key:f,action:"protect",targetedPlayer:k}}));break;case"detective":if(w==f){Se.message("Cannot act upon self.");break}k||t(7,k=w);break}}function fe(w){t(18,d={}),t(5,v=null),t(19,y={}),t(7,k=null)}function ee(){h&&c[f].isAlive?(o.send({type:"broadcast",event:"action",payload:{key:f,action:"confirm"}}),Se.success("Confirmed")):Se.message("Not required")}const Q=(w,re)=>S(w,re),R=w=>W(w);return i.$$set=w=>{"channel"in w&&t(17,o=w.channel),"finalizedPlayers"in w&&t(2,a=w.finalizedPlayers),"assignedRoles"in w&&t(3,l=w.assignedRoles),"gameState"in w&&t(0,c=w.gameState),"gameTime"in w&&t(1,u=w.gameTime),"username"in w&&t(4,f=w.username)},i.$$.update=()=>{i.$$.dirty[0]&262144&&t(11,s=Object.keys(d).reduce((w,re,P)=>(d[re]&&(w[d[re]]||(w[d[re]]=[]),w[d[re]].push(re)),w),{})),i.$$.dirty[0]&4&&t(10,r=a.reduce((w,re,P)=>(w[re]=P,w),{})),i.$$.dirty[0]&524288&&t(9,n=Object.keys(y).reduce((w,re,P)=>(y[re]&&(w[y[re]]||(w[y[re]]=[]),w[y[re]].push(re)),w),{})),i.$$.dirty[0]&131120&&o.send({type:"broadcast",event:"action",payload:{key:f,action:"vote",votedPlayer:v}})},[c,u,a,l,f,v,p,k,V,n,r,s,h,x,S,W,ee,o,d,y,Q,R]}class Cn extends ge{constructor(e){super(),me(this,e,Ql,Wl,_e,{channel:17,finalizedPlayers:2,assignedRoles:3,gameState:0,gameTime:1,username:4},null,[-1,-1])}}const[Xt,Yt]=Sl({duration:i=>Math.sqrt(i*200),fallback(i,e){const t=getComputedStyle(i),s=t.transform==="none"?"":t.transform;return{duration:600,easing:Bn,css:r=>`
				transform: ${s} scale(${r});
				opacity: ${r}
			`}}});function Pr(i,e,t){const s=i.slice();return s[26]=e[t],s[27]=e,s[28]=t,s}function Tr(i,e,t){const s=i.slice();return s[26]=e[t],s}function Er(i,e,t){const s=i.slice();return s[26]=e[t],s}function Xl(i){let e,t,s,r,n,o,a,l;t=new Je({props:{$$slots:{default:[Zl]},$$scope:{ctx:i}}}),t.$on("click",i[15]);const c=[ec,xl],u=[];function f(h,d){return h[8]?0:1}return r=f(i),n=u[r]=c[r](i),a=new Cn({props:{finalizedPlayers:i[10],assignedRoles:i[11],username:i[1],channel:i[0],gameState:i[7],gameTime:i[6]}}),{c(){e=J("div"),T(t.$$.fragment),s=F(),n.c(),o=F(),T(a.$$.fragment),this.h()},l(h){e=G(h,"DIV",{class:!0});var d=te(e);E(t.$$.fragment,d),s=H(d),n.l(d),d.forEach(m),o=H(h),E(a.$$.fragment,h),this.h()},h(){X(e,"class","mx-auto mb-8 flex max-w-sm items-center gap-4 rounded-md border bg-card p-2")},m(h,d){$(h,e,d),C(t,e,null),I(e,s),u[r].m(e,null),$(h,o,d),C(a,h,d),l=!0},p(h,d){const p={};d[0]&12288|d[1]&4&&(p.$$scope={dirty:d,ctx:h}),t.$set(p);let b=r;r=f(h),r===b?u[r].p(h,d):(oe(),g(u[b],1,1,()=>{u[b]=null}),ae(),n=u[r],n?n.p(h,d):(n=u[r]=c[r](h),n.c()),_(n,1),n.m(e,null));const v={};d[0]&1024&&(v.finalizedPlayers=h[10]),d[0]&2048&&(v.assignedRoles=h[11]),d[0]&2&&(v.username=h[1]),d[0]&1&&(v.channel=h[0]),d[0]&128&&(v.gameState=h[7]),d[0]&64&&(v.gameTime=h[6]),a.$set(v)},i(h){l||(_(t.$$.fragment,h),_(n),_(a.$$.fragment,h),l=!0)},o(h){g(t.$$.fragment,h),g(n),g(a.$$.fragment,h),l=!1},d(h){h&&(m(e),m(o)),O(t),u[r].d(),O(a,h)}}}function Yl(i){let e,t;return e=new ws({props:{class:"mx-auto max-w-sm bg-card",$$slots:{default:[gc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[0]&540|r[1]&4&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Zl(i){let e,t,s,r=i[12].length+"",n;return{c(){e=Y("Proceed: "),t=Y(i[13]),s=Y("/"),n=Y(r)},l(o){e=Z(o,"Proceed: "),t=Z(o,i[13]),s=Z(o,"/"),n=Z(o,r)},m(o,a){$(o,e,a),$(o,t,a),$(o,s,a),$(o,n,a)},p(o,a){a[0]&8192&&ye(t,o[13]),a[0]&4096&&r!==(r=o[12].length+"")&&ye(n,r)},d(o){o&&(m(e),m(t),m(s),m(n))}}}function xl(i){let e,t;return e=new Je({props:{$$slots:{default:[tc]},$$scope:{ctx:i}}}),e.$on("click",i[16]),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[1]&4&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function ec(i){let e,t;return e=new Je({props:{$$slots:{default:[sc]},$$scope:{ctx:i}}}),e.$on("click",i[17]),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r[1]&4&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function tc(i){let e;return{c(){e=Y("End Game")},l(t){e=Z(t,"End Game")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function sc(i){let e;return{c(){e=Y("New Game")},l(t){e=Z(t,"New Game")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function rc(i){let e;return{c(){e=Y("Settings")},l(t){e=Z(t,"Settings")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function nc(i){let e;return{c(){e=Y("Players online in room")},l(t){e=Z(t,"Players online in room")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function ic(i){let e,t,s,r;return e=new Ps({props:{tag:"h1",$$slots:{default:[rc]},$$scope:{ctx:i}}}),s=new Ts({props:{$$slots:{default:[nc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment)},l(n){E(e.$$.fragment,n),t=H(n),E(s.$$.fragment,n)},m(n,o){C(e,n,o),$(n,t,o),C(s,n,o),r=!0},p(n,o){const a={};o[1]&4&&(a.$$scope={dirty:o,ctx:n}),e.$set(a);const l={};o[1]&4&&(l.$$scope={dirty:o,ctx:n}),s.$set(l)},i(n){r||(_(e.$$.fragment,n),_(s.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),g(s.$$.fragment,n),r=!1},d(n){n&&m(t),O(e,n),O(s,n)}}}function Cr(i){let e,t="No Players Selected";return{c(){e=J("li"),e.textContent=t,this.h()},l(s){e=G(s,"LI",{class:!0,"data-svelte-h":!0}),at(e)!=="svelte-p012nz"&&(e.textContent=t),this.h()},h(){X(e,"class","text-center text-xs text-muted-foreground h-0")},m(s,r){$(s,e,r)},p:de,d(s){s&&m(e)}}}function Or(i){let e,t;return e=new tt({props:{class:"absolute right-2 bg-opacity-75",$$slots:{default:[oc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function oc(i){let e;return{c(){e=Y("host")},l(t){e=Z(t,"host")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function ac(i){let e=i[26]+"",t,s,r,n,o=i[2][i[26]].isHost&&Or(i);return{c(){t=Y(e),s=F(),o&&o.c(),r=le()},l(a){t=Z(a,e),s=H(a),o&&o.l(a),r=le()},m(a,l){$(a,t,l),$(a,s,l),o&&o.m(a,l),$(a,r,l),n=!0},p(a,l){(!n||l[0]&8)&&e!==(e=a[26]+"")&&ye(t,e),a[2][a[26]].isHost?o?l[0]&12&&_(o,1):(o=Or(a),o.c(),_(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),ae())},i(a){n||(_(o),n=!0)},o(a){g(o),n=!1},d(a){a&&(m(t),m(s),m(r)),o&&o.d(a)}}}function Ar(i,e){let t,s,r,n,o,a,l=de,c;function u(...f){return e[20](e[26],...f)}return s=new jt({props:{class:"relative h-8 w-full",pressed:!0,onPressedChange:u,$$slots:{default:[ac]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=J("li"),T(s.$$.fragment),r=F(),this.h()},l(f){t=G(f,"LI",{class:!0});var h=te(t);E(s.$$.fragment,h),r=H(h),h.forEach(m),this.h()},h(){X(t,"class","my-1 w-4/5 max-w-sm"),this.first=t},m(f,h){$(f,t,h),C(s,t,null),I(t,r),c=!0},p(f,h){e=f;const d={};h[0]&12&&(d.onPressedChange=u),h[0]&12|h[1]&4&&(d.$$scope={dirty:h,ctx:e}),s.$set(d)},r(){a=t.getBoundingClientRect()},f(){dt(t),l(),Et(t,a)},a(){l(),l=ht(t,a,gt,{duration:300})},i(f){c||(_(s.$$.fragment,f),f&&Tt(()=>{c&&(o&&o.end(1),n=Pt(t,Yt,{key:e[26]}),n.start())}),c=!0)},o(f){g(s.$$.fragment,f),n&&n.invalidate(),f&&(o=qt(t,Xt,{key:e[26]})),c=!1},d(f){f&&m(t),O(s),f&&o&&o.end()}}}function jr(i){let e,t;return e=new tt({props:{class:"absolute right-2 bg-opacity-75",$$slots:{default:[lc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function lc(i){let e;return{c(){e=Y("host")},l(t){e=Z(t,"host")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function cc(i){let e=i[26]+"",t,s,r,n,o=i[2][i[26]].isHost&&jr(i);return{c(){t=Y(e),s=F(),o&&o.c(),r=le()},l(a){t=Z(a,e),s=H(a),o&&o.l(a),r=le()},m(a,l){$(a,t,l),$(a,s,l),o&&o.m(a,l),$(a,r,l),n=!0},p(a,l){(!n||l[0]&512)&&e!==(e=a[26]+"")&&ye(t,e),a[2][a[26]].isHost?o?l[0]&516&&_(o,1):(o=jr(a),o.c(),_(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),ae())},i(a){n||(_(o),n=!0)},o(a){g(o),n=!1},d(a){a&&(m(t),m(s),m(r)),o&&o.d(a)}}}function Rr(i,e){let t,s,r,n,o,a,l=de,c;function u(...f){return e[21](e[26],...f)}return s=new jt({props:{class:"relative h-8 w-full",pressed:!1,onPressedChange:u,variant:"outline",$$slots:{default:[cc]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=J("li"),T(s.$$.fragment),r=F(),this.h()},l(f){t=G(f,"LI",{class:!0});var h=te(t);E(s.$$.fragment,h),r=H(h),h.forEach(m),this.h()},h(){X(t,"class","my-1 w-4/5 max-w-sm"),this.first=t},m(f,h){$(f,t,h),C(s,t,null),I(t,r),c=!0},p(f,h){e=f;const d={};h[0]&516&&(d.onPressedChange=u),h[0]&516|h[1]&4&&(d.$$scope={dirty:h,ctx:e}),s.$set(d)},r(){a=t.getBoundingClientRect()},f(){dt(t),l(),Et(t,a)},a(){l(),l=ht(t,a,gt,{duration:300})},i(f){c||(_(s.$$.fragment,f),f&&Tt(()=>{c&&(o&&o.end(1),n=Pt(t,Yt,{key:e[26]}),n.start())}),c=!0)},o(f){g(s.$$.fragment,f),n&&n.invalidate(),f&&(o=qt(t,Xt,{key:e[26]})),c=!1},d(f){f&&m(t),O(s),f&&o&&o.end()}}}function uc(i){let e=i[26]+"",t,s;return{c(){t=Y(e),s=Y(":")},l(r){t=Z(r,e),s=Z(r,":")},m(r,n){$(r,t,n),$(r,s,n)},p(r,n){n[0]&16&&e!==(e=r[26]+"")&&ye(t,e)},d(r){r&&(m(t),m(s))}}}function Ir(i){let e,t,s,r,n,o,a;t=new Yr({props:{class:"w-16 capitalize",$$slots:{default:[uc]},$$scope:{ctx:i}}});function l(u){i[22](u,i[26])}let c={type:"number",class:"w-14",min:"0"};return i[4][i[26]]!==void 0&&(c.value=i[4][i[26]]),r=new Hn({props:c}),Ge.push(()=>_s(r,"value",l)),{c(){e=J("div"),T(t.$$.fragment),s=F(),T(r.$$.fragment),o=F(),this.h()},l(u){e=G(u,"DIV",{class:!0});var f=te(e);E(t.$$.fragment,f),s=H(f),E(r.$$.fragment,f),o=H(f),f.forEach(m),this.h()},h(){X(e,"class","flex items-center gap-2")},m(u,f){$(u,e,f),C(t,e,null),I(e,s),C(r,e,null),I(e,o),a=!0},p(u,f){i=u;const h={};f[0]&16|f[1]&4&&(h.$$scope={dirty:f,ctx:i}),t.$set(h);const d={};!n&&f[0]&16&&(n=!0,d.value=i[4][i[26]],gs(()=>n=!1)),r.$set(d)},i(u){a||(_(t.$$.fragment,u),_(r.$$.fragment,u),a=!0)},o(u){g(t.$$.fragment,u),g(r.$$.fragment,u),a=!1},d(u){u&&m(e),O(t),O(r)}}}function fc(i){let e,t,s="Select Players:",r,n,o=[],a=new Map,l,c,u,f,h,d=i[3].length+"",p,b,v=i[3].length+i[9].length+"",k,y,V,x,S,W=[],fe=new Map,ee,Q,R,w="Customize Roles:",re,P,q,M,K,N,pe=Object.values(i[4]).reduce(i[23],0)+"",ve,ie,L=be(i[3]);const U=A=>A[26];for(let A=0;A<L.length;A+=1){let D=Er(i,L,A),B=U(D);a.set(B,o[A]=Ar(B,D))}let j=null;L.length||(j=Cr()),V=new En({props:{class:"mb-4"}});let Oe=be(i[9]);const mt=A=>A[26];for(let A=0;A<Oe.length;A+=1){let D=Tr(i,Oe,A),B=mt(D);fe.set(B,W[A]=Rr(B,D))}let Me=be(Object.keys(i[4])),ce=[];for(let A=0;A<Me.length;A+=1)ce[A]=Ir(Pr(i,Me,A));const Rt=A=>g(ce[A],1,1,()=>{ce[A]=null});return{c(){e=J("div"),t=J("h2"),t.textContent=s,r=F(),n=J("ul");for(let A=0;A<o.length;A+=1)o[A].c();j&&j.c(),l=F(),c=J("div"),u=J("div"),f=Y("Selected: "),h=J("span"),p=Y(d),b=Y(" / "),k=Y(v),y=F(),T(V.$$.fragment),x=F(),S=J("ul");for(let A=0;A<W.length;A+=1)W[A].c();ee=F(),Q=J("div"),R=J("h2"),R.textContent=w,re=F(),P=J("form");for(let A=0;A<ce.length;A+=1)ce[A].c();q=F(),M=J("div"),K=Y("Total: "),N=J("span"),ve=Y(pe),this.h()},l(A){e=G(A,"DIV",{});var D=te(e);t=G(D,"H2",{class:!0,"data-svelte-h":!0}),at(t)!=="svelte-18a97qg"&&(t.textContent=s),r=H(D),n=G(D,"UL",{class:!0});var B=te(n);for(let De=0;De<o.length;De+=1)o[De].l(B);j&&j.l(B),B.forEach(m),l=H(D),c=G(D,"DIV",{});var We=te(c);u=G(We,"DIV",{class:!0});var pt=te(u);f=Z(pt,"Selected: "),h=G(pt,"SPAN",{class:!0});var Is=te(h);p=Z(Is,d),Is.forEach(m),b=Z(pt," / "),k=Z(pt,v),pt.forEach(m),y=H(We),E(V.$$.fragment,We),We.forEach(m),x=H(D),S=G(D,"UL",{class:!0});var Ls=te(S);for(let De=0;De<W.length;De+=1)W[De].l(Ls);Ls.forEach(m),D.forEach(m),ee=H(A),Q=G(A,"DIV",{class:!0});var st=te(Q);R=G(st,"H2",{class:!0,"data-svelte-h":!0}),at(R)!=="svelte-hw6q10"&&(R.textContent=w),re=H(st),P=G(st,"FORM",{class:!0,action:!0});var Ds=te(P);for(let De=0;De<ce.length;De+=1)ce[De].l(Ds);Ds.forEach(m),q=H(st),M=G(st,"DIV",{class:!0});var Zt=te(M);K=Z(Zt,"Total: "),N=G(Zt,"SPAN",{class:!0});var Ns=te(N);ve=Z(Ns,pe),Ns.forEach(m),Zt.forEach(m),st.forEach(m),this.h()},h(){X(t,"class","mb-4 font-semibold"),X(n,"class","flex flex-col items-center"),X(h,"class","text-md font-bold"),X(u,"class","ml-4 mt-4 text-xs text-muted-foreground"),X(S,"class","flex flex-col items-center"),X(R,"class","mb-4 font-semibold"),X(P,"class","grid grid-cols-2 space-y-1"),X(P,"action","javascript:void();"),X(N,"class","text-md font-bold"),X(M,"class","ml-4 mt-4 text-xs text-muted-foreground"),X(Q,"class","mt-6")},m(A,D){$(A,e,D),I(e,t),I(e,r),I(e,n);for(let B=0;B<o.length;B+=1)o[B]&&o[B].m(n,null);j&&j.m(n,null),I(e,l),I(e,c),I(c,u),I(u,f),I(u,h),I(h,p),I(u,b),I(u,k),I(c,y),C(V,c,null),I(e,x),I(e,S);for(let B=0;B<W.length;B+=1)W[B]&&W[B].m(S,null);$(A,ee,D),$(A,Q,D),I(Q,R),I(Q,re),I(Q,P);for(let B=0;B<ce.length;B+=1)ce[B]&&ce[B].m(P,null);I(Q,q),I(Q,M),I(M,K),I(M,N),I(N,ve),ie=!0},p(A,D){if(D[0]&12){L=be(A[3]),oe();for(let B=0;B<o.length;B+=1)o[B].r();o=ct(o,D,U,1,A,L,a,n,ut,Ar,null,Er);for(let B=0;B<o.length;B+=1)o[B].a();ae(),!L.length&&j?j.p(A,D):L.length?j&&(j.d(1),j=null):(j=Cr(),j.c(),j.m(n,null))}if((!ie||D[0]&8)&&d!==(d=A[3].length+"")&&ye(p,d),(!ie||D[0]&520)&&v!==(v=A[3].length+A[9].length+"")&&ye(k,v),D[0]&516){Oe=be(A[9]),oe();for(let B=0;B<W.length;B+=1)W[B].r();W=ct(W,D,mt,1,A,Oe,fe,S,ut,Rr,null,Tr);for(let B=0;B<W.length;B+=1)W[B].a();ae()}if(D[0]&16){Me=be(Object.keys(A[4]));let B;for(B=0;B<Me.length;B+=1){const We=Pr(A,Me,B);ce[B]?(ce[B].p(We,D),_(ce[B],1)):(ce[B]=Ir(We),ce[B].c(),_(ce[B],1),ce[B].m(P,null))}for(oe(),B=Me.length;B<ce.length;B+=1)Rt(B);ae()}(!ie||D[0]&16)&&pe!==(pe=Object.values(A[4]).reduce(A[23],0)+"")&&ye(ve,pe)},i(A){if(!ie){for(let D=0;D<L.length;D+=1)_(o[D]);_(V.$$.fragment,A);for(let D=0;D<Oe.length;D+=1)_(W[D]);for(let D=0;D<Me.length;D+=1)_(ce[D]);ie=!0}},o(A){for(let D=0;D<o.length;D+=1)g(o[D]);g(V.$$.fragment,A);for(let D=0;D<W.length;D+=1)g(W[D]);ce=ce.filter(Boolean);for(let D=0;D<ce.length;D+=1)g(ce[D]);ie=!1},d(A){A&&(m(e),m(ee),m(Q));for(let D=0;D<o.length;D+=1)o[D].d();j&&j.d(),O(V);for(let D=0;D<W.length;D+=1)W[D].d();Ht(ce,A)}}}function hc(i){let e;return{c(){e=Y("Start Game")},l(t){e=Z(t,"Start Game")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function dc(i){let e;return{c(){e=Y("Exit Room")},l(t){e=Z(t,"Exit Room")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function _c(i){let e,t,s,r;return e=new Je({props:{$$slots:{default:[hc]},$$scope:{ctx:i}}}),e.$on("click",i[14]),s=new Je({props:{variant:"outline",href:"./",$$slots:{default:[dc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment)},l(n){E(e.$$.fragment,n),t=H(n),E(s.$$.fragment,n)},m(n,o){C(e,n,o),$(n,t,o),C(s,n,o),r=!0},p(n,o){const a={};o[1]&4&&(a.$$scope={dirty:o,ctx:n}),e.$set(a);const l={};o[1]&4&&(l.$$scope={dirty:o,ctx:n}),s.$set(l)},i(n){r||(_(e.$$.fragment,n),_(s.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),g(s.$$.fragment,n),r=!1},d(n){n&&m(t),O(e,n),O(s,n)}}}function gc(i){let e,t,s,r,n,o;return e=new $s({props:{$$slots:{default:[ic]},$$scope:{ctx:i}}}),s=new ks({props:{$$slots:{default:[fc]},$$scope:{ctx:i}}}),n=new Ss({props:{class:"flex justify-between",$$slots:{default:[_c]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment),r=F(),T(n.$$.fragment)},l(a){E(e.$$.fragment,a),t=H(a),E(s.$$.fragment,a),r=H(a),E(n.$$.fragment,a)},m(a,l){C(e,a,l),$(a,t,l),C(s,a,l),$(a,r,l),C(n,a,l),o=!0},p(a,l){const c={};l[1]&4&&(c.$$scope={dirty:l,ctx:a}),e.$set(c);const u={};l[0]&540|l[1]&4&&(u.$$scope={dirty:l,ctx:a}),s.$set(u);const f={};l[1]&4&&(f.$$scope={dirty:l,ctx:a}),n.$set(f)},i(a){o||(_(e.$$.fragment,a),_(s.$$.fragment,a),_(n.$$.fragment,a),o=!0)},o(a){g(e.$$.fragment,a),g(s.$$.fragment,a),g(n.$$.fragment,a),o=!1},d(a){a&&(m(t),m(r)),O(e,a),O(s,a),O(n,a)}}}function mc(i){let e,t,s,r;const n=[Yl,Xl],o=[];function a(l,c){return l[5]=="preparation"?0:l[5]=="play"?1:-1}return~(e=a(i))&&(t=o[e]=n[e](i)),{c(){t&&t.c(),s=le()},l(l){t&&t.l(l),s=le()},m(l,c){~e&&o[e].m(l,c),$(l,s,c),r=!0},p(l,c){let u=e;e=a(l),e===u?~e&&o[e].p(l,c):(t&&(oe(),g(o[u],1,1,()=>{o[u]=null}),ae()),~e?(t=o[e],t?t.p(l,c):(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s)):t=null)},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),~e&&o[e].d(l)}}}function pc(i,e,t){let s,r,{channel:n}=e,{username:o}=e,a={},l=[],c=[],u={detective:1,doctor:1,mafia:1,prostitute:1,villager:1},f="preparation",h=[],d={},p="day",b={},v={killed:null,healed:null,protected:null},k={},y={},V=!1,x;n.on("presence",{event:"sync"},()=>{const P=n.presenceState(),q={};let M=!1;for(let K in P)a[K]?q[K]=a[K]:(q[K]={...P[K][0],isSelected:!1},q[K].isHost&&M&&(x!=null&&Se.dismiss(x),x=Se.warning("Two or more hosts in this room.",{duration:Number.POSITIVE_INFINITY}))),M=q[K].isHost||M;t(2,a=q)}).on("broadcast",{event:"action"},({payload:P})=>{if(!h.every(q=>q!=P.key))switch(P.action){case"vote":t(19,y[P.key]=P.votedPlayer,y);break;case"kill":d[P.key]=="mafia"&&(v.killed=P.targetedPlayer);break;case"heal":d[P.key]=="doctor"&&(v.healed=P.targetedPlayer);break;case"protect":d[P.key]=="prostitute"&&(v.protected=P.targetedPlayer);break;case"confirm":r.some(q=>q==P.key)&&t(18,k[P.key]=!0,k)}});function S(){t(10,h=l);const P=Object.keys(u).reduce((q,M)=>q.concat(Array(parseInt(u[M])).fill(M)),[]);if(t(7,b={}),t(11,d={}),P.length!=h.length){Se.error("Unequal number of selected players and roles set.");return}for(let q=P.length-1;q>0;q--){const M=Math.floor(Math.random()*(q+1));[P[q],P[M]]=[P[M],P[q]]}h.forEach((q,M)=>{t(11,d[q]=P[M],d),t(7,b[q]={isAlive:!0,isKilled:!1,isProtected:!1,isHealed:!1},b)}),n.send({type:"broadcast",event:"play",payload:{gameTime:p,finalizedPlayers:h,assignedRoles:d,gameState:b}}),t(6,p="day"),t(5,f="play"),t(8,V=!1)}function W(P,q=!1){if(!q&&s<r.length){Se("All players have not confirmed. Do you still want to proceed?",{action:{label:"Proceed",onClick:()=>W(P,!0)}});return}if(t(18,k={}),p=="day"){Object.values(b).forEach(N=>{N.isHealed=!1,N.isProtected=!1,N.isKilled=!1});const M=r.reduce((N,pe)=>(N[pe]=0,N),{});Object.values(y).forEach(N=>{N&&M[N]++});const K=Math.max(...Object.values(M));if(K>0){const N=Object.keys(M).filter(ve=>M[ve]==K),pe=N[Math.floor(Math.random()*N.length)];t(7,b[pe].isAlive=!1,b)}t(19,y={}),t(6,p="night"),v={killed:null,healed:null,protected:null}}else if(p=="night"){for(let M of r){if(d[M]=="mafia"&&!v.killed){Se.message("Mafia has not played yet.");return}if(d[M]=="doctor"&&!v.healed){Se.message("Doctor has not played yet.");return}if(d[M]=="prostitute"&&!v.protected){Se.message("Prostitute has not played yet.");return}}v.killed&&(t(7,b[v.killed].isKilled=!0,b),t(7,b[v.killed].isAlive=v.killed==v.healed,b)),v.healed&&t(7,b[v.healed].isHealed=!0,b),v.protected&&t(7,b[v.protected].isProtected=!0,b),t(6,p="day"),t(19,y={})}n.send({type:"broadcast",event:"update",payload:{proceed:!0,gameTime:p,gameState:b}})}function fe(){t(8,V=!0)}function ee(){t(5,f="preparation")}const Q=(P,q)=>{t(2,a[P].isSelected=q,a)},R=(P,q)=>{t(2,a[P].isSelected=q,a)};function w(P,q){i.$$.not_equal(u[q],P)&&(u[q]=P,t(4,u))}const re=(P,q)=>P+parseInt(q);return i.$$set=P=>{"channel"in P&&t(0,n=P.channel),"username"in P&&t(1,o=P.username)},i.$$.update=()=>{if(i.$$.dirty[0]&262144&&t(13,s=Object.values(k).reduce((P,q)=>P+q,0)),i.$$.dirty[0]&128&&t(12,r=Object.keys(b).filter(P=>b[P].isAlive)),i.$$.dirty[0]&4){const P=[],q=[];for(let M in a)a[M].isSelected?P.push(M):q.push(M);t(3,l=P),t(9,c=q)}i.$$.dirty[0]&57&&n.send({type:"broadcast",event:f,payload:{selectedPlayers:l,rolesCount:u}}),i.$$.dirty[0]&65&&n.send({type:"broadcast",event:"update",payload:{gameTime:p}}),i.$$.dirty[0]&524289&&n.send({type:"broadcast",event:"update",payload:{votes:y}}),i.$$.dirty[0]&257&&n.send({type:"broadcast",event:"update",payload:{gameEnded:V}})},[n,o,a,l,u,f,p,b,V,c,h,d,r,s,S,W,fe,ee,k,y,Q,R,w,re]}class vc extends ge{constructor(e){super(),me(this,e,pc,mc,_e,{channel:0,username:1},null,[-1,-1])}}function Lr(i,e,t){const s=i.slice();return s[12]=e[t],s}function Dr(i,e,t){const s=i.slice();return s[12]=e[t],s}function Nr(i,e,t){const s=i.slice();return s[12]=e[t],s}function bc(i){let e,t;return e=new Cn({props:{finalizedPlayers:i[6],assignedRoles:i[7],username:i[1],channel:i[0],gameState:i[9],gameTime:i[8]}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r&64&&(n.finalizedPlayers=s[6]),r&128&&(n.assignedRoles=s[7]),r&2&&(n.username=s[1]),r&1&&(n.channel=s[0]),r&512&&(n.gameState=s[9]),r&256&&(n.gameTime=s[8]),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function yc(i){let e,t;return e=new ws({props:{class:"mx-auto max-w-sm",$$slots:{default:[jc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r&525356&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function wc(i){let e;return{c(){e=Y("Waiting for Host to start...")},l(t){e=Z(t,"Waiting for Host to start...")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function $c(i){let e;return{c(){e=Y("Settings set by host")},l(t){e=Z(t,"Settings set by host")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function kc(i){let e,t,s,r;return e=new Ps({props:{tag:"h1",$$slots:{default:[wc]},$$scope:{ctx:i}}}),s=new Ts({props:{$$slots:{default:[$c]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment)},l(n){E(e.$$.fragment,n),t=H(n),E(s.$$.fragment,n)},m(n,o){C(e,n,o),$(n,t,o),C(s,n,o),r=!0},p(n,o){const a={};o&524288&&(a.$$scope={dirty:o,ctx:n}),e.$set(a);const l={};o&524288&&(l.$$scope={dirty:o,ctx:n}),s.$set(l)},i(n){r||(_(e.$$.fragment,n),_(s.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),g(s.$$.fragment,n),r=!1},d(n){n&&m(t),O(e,n),O(s,n)}}}function Ur(i){let e,t="No Players Selected";return{c(){e=J("li"),e.textContent=t,this.h()},l(s){e=G(s,"LI",{class:!0,"data-svelte-h":!0}),at(e)!=="svelte-p012nz"&&(e.textContent=t),this.h()},h(){X(e,"class","text-center text-xs text-muted-foreground h-0")},m(s,r){$(s,e,r)},p:de,d(s){s&&m(e)}}}function Mr(i){let e,t;return e=new tt({props:{class:"absolute right-2 bg-opacity-75",$$slots:{default:[Sc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Sc(i){let e;return{c(){e=Y("host")},l(t){e=Z(t,"host")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function Pc(i){let e=i[12]+"",t,s,r,n,o=i[2][i[12]].isHost&&Mr(i);return{c(){t=Y(e),s=F(),o&&o.c(),r=le()},l(a){t=Z(a,e),s=H(a),o&&o.l(a),r=le()},m(a,l){$(a,t,l),$(a,s,l),o&&o.m(a,l),$(a,r,l),n=!0},p(a,l){(!n||l&8)&&e!==(e=a[12]+"")&&ye(t,e),a[2][a[12]].isHost?o?l&12&&_(o,1):(o=Mr(a),o.c(),_(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),ae())},i(a){n||(_(o),n=!0)},o(a){g(o),n=!1},d(a){a&&(m(t),m(s),m(r)),o&&o.d(a)}}}function Br(i,e){let t,s,r,n,o,a,l=de,c;return s=new jt({props:{class:"relative h-8 w-full disabled:opacity-100",disabled:!0,pressed:!0,$$slots:{default:[Pc]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=J("li"),T(s.$$.fragment),r=F(),this.h()},l(u){t=G(u,"LI",{class:!0});var f=te(t);E(s.$$.fragment,f),r=H(f),f.forEach(m),this.h()},h(){X(t,"class","my-1 w-4/5 max-w-sm"),this.first=t},m(u,f){$(u,t,f),C(s,t,null),I(t,r),c=!0},p(u,f){e=u;const h={};f&524300&&(h.$$scope={dirty:f,ctx:e}),s.$set(h)},r(){a=t.getBoundingClientRect()},f(){dt(t),l(),Et(t,a)},a(){l(),l=ht(t,a,gt,{duration:300})},i(u){c||(_(s.$$.fragment,u),u&&Tt(()=>{c&&(o&&o.end(1),n=Pt(t,Yt,{key:e[12]}),n.start())}),c=!0)},o(u){g(s.$$.fragment,u),n&&n.invalidate(),u&&(o=qt(t,Xt,{key:e[12]})),c=!1},d(u){u&&m(t),O(s),u&&o&&o.end()}}}function zr(i){let e,t;return e=new tt({props:{class:"absolute right-2 bg-opacity-75",$$slots:{default:[Tc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Tc(i){let e;return{c(){e=Y("host")},l(t){e=Z(t,"host")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function Ec(i){let e=i[12]+"",t,s,r,n,o=i[2][i[12]].isHost&&zr(i);return{c(){t=Y(e),s=F(),o&&o.c(),r=le()},l(a){t=Z(a,e),s=H(a),o&&o.l(a),r=le()},m(a,l){$(a,t,l),$(a,s,l),o&&o.m(a,l),$(a,r,l),n=!0},p(a,l){(!n||l&1024)&&e!==(e=a[12]+"")&&ye(t,e),a[2][a[12]].isHost?o?l&1028&&_(o,1):(o=zr(a),o.c(),_(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),ae())},i(a){n||(_(o),n=!0)},o(a){g(o),n=!1},d(a){a&&(m(t),m(s),m(r)),o&&o.d(a)}}}function qr(i,e){let t,s,r,n,o,a,l=de,c;return s=new jt({props:{class:"relative h-8 w-full disabled:opacity-100",disabled:!0,pressed:!1,variant:"outline",$$slots:{default:[Ec]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=J("li"),T(s.$$.fragment),r=F(),this.h()},l(u){t=G(u,"LI",{class:!0});var f=te(t);E(s.$$.fragment,f),r=H(f),f.forEach(m),this.h()},h(){X(t,"class","my-1 w-4/5 max-w-sm"),this.first=t},m(u,f){$(u,t,f),C(s,t,null),I(t,r),c=!0},p(u,f){e=u;const h={};f&525316&&(h.$$scope={dirty:f,ctx:e}),s.$set(h)},r(){a=t.getBoundingClientRect()},f(){dt(t),l(),Et(t,a)},a(){l(),l=ht(t,a,gt,{duration:300})},i(u){c||(_(s.$$.fragment,u),u&&Tt(()=>{c&&(o&&o.end(1),n=Pt(t,Yt,{key:e[12]}),n.start())}),c=!0)},o(u){g(s.$$.fragment,u),n&&n.invalidate(),u&&(o=qt(t,Xt,{key:e[12]})),c=!1},d(u){u&&m(t),O(s),u&&o&&o.end()}}}function Fr(i){let e,t,s=i[12]+"",r,n,o,a,l=i[5][i[12]]+"",c,u;return{c(){e=J("div"),t=J("span"),r=Y(s),n=Y(":"),o=F(),a=J("span"),c=Y(l),u=F(),this.h()},l(f){e=G(f,"DIV",{class:!0});var h=te(e);t=G(h,"SPAN",{class:!0});var d=te(t);r=Z(d,s),n=Z(d,":"),d.forEach(m),o=H(h),a=G(h,"SPAN",{type:!0,class:!0});var p=te(a);c=Z(p,l),p.forEach(m),u=H(h),h.forEach(m),this.h()},h(){X(t,"class","w-16 text-sm font-medium capitalize"),X(a,"type","number"),X(a,"class","w-14 rounded border p-2 text-center shadow-sm"),X(e,"class","flex items-center gap-4")},m(f,h){$(f,e,h),I(e,t),I(t,r),I(t,n),I(e,o),I(e,a),I(a,c),I(e,u)},p(f,h){h&32&&s!==(s=f[12]+"")&&ye(r,s),h&32&&l!==(l=f[5][f[12]]+"")&&ye(c,l)},d(f){f&&m(e)}}}function Cc(i){let e,t,s="Selected Players:",r,n,o=[],a=new Map,l,c,u,f,h=i[3].length+"",d,p,b=i[3].length+i[10].length+"",v,k,y,V,x,S=[],W=new Map,fe,ee,Q,R="Customized Roles:",w,re,P,q=be(i[3]);const M=L=>L[12];for(let L=0;L<q.length;L+=1){let U=Nr(i,q,L),j=M(U);a.set(j,o[L]=Br(j,U))}let K=null;q.length||(K=Ur()),y=new En({props:{class:"mb-4"}});let N=be(i[10]);const pe=L=>L[12];for(let L=0;L<N.length;L+=1){let U=Dr(i,N,L),j=pe(U);W.set(j,S[L]=qr(j,U))}let ve=be(Object.keys(i[5])),ie=[];for(let L=0;L<ve.length;L+=1)ie[L]=Fr(Lr(i,ve,L));return{c(){e=J("div"),t=J("h2"),t.textContent=s,r=F(),n=J("ul");for(let L=0;L<o.length;L+=1)o[L].c();K&&K.c(),l=F(),c=J("div"),u=Y("Selected: "),f=J("span"),d=Y(h),p=Y(" / "),v=Y(b),k=F(),T(y.$$.fragment),V=F(),x=J("ul");for(let L=0;L<S.length;L+=1)S[L].c();fe=F(),ee=J("div"),Q=J("h2"),Q.textContent=R,w=F(),re=J("form");for(let L=0;L<ie.length;L+=1)ie[L].c();this.h()},l(L){e=G(L,"DIV",{});var U=te(e);t=G(U,"H2",{class:!0,"data-svelte-h":!0}),at(t)!=="svelte-1cclgdb"&&(t.textContent=s),r=H(U),n=G(U,"UL",{class:!0});var j=te(n);for(let A=0;A<o.length;A+=1)o[A].l(j);K&&K.l(j),j.forEach(m),l=H(U),c=G(U,"DIV",{class:!0});var Oe=te(c);u=Z(Oe,"Selected: "),f=G(Oe,"SPAN",{class:!0});var mt=te(f);d=Z(mt,h),mt.forEach(m),p=Z(Oe," / "),v=Z(Oe,b),Oe.forEach(m),k=H(U),E(y.$$.fragment,U),V=H(U),x=G(U,"UL",{class:!0});var Me=te(x);for(let A=0;A<S.length;A+=1)S[A].l(Me);Me.forEach(m),U.forEach(m),fe=H(L),ee=G(L,"DIV",{class:!0});var ce=te(ee);Q=G(ce,"H2",{class:!0,"data-svelte-h":!0}),at(Q)!=="svelte-1p3v3z2"&&(Q.textContent=R),w=H(ce),re=G(ce,"FORM",{class:!0,action:!0});var Rt=te(re);for(let A=0;A<ie.length;A+=1)ie[A].l(Rt);Rt.forEach(m),ce.forEach(m),this.h()},h(){X(t,"class","mb-4 font-semibold"),X(n,"class","flex flex-col items-center"),X(f,"class","text-md font-bold"),X(c,"class","ml-4 mt-4 text-xs text-muted-foreground"),X(x,"class","flex flex-col items-center"),X(Q,"class","mb-4 font-semibold"),X(re,"class","grid grid-cols-2 space-y-1"),X(re,"action","javascript:void();"),X(ee,"class","mt-6")},m(L,U){$(L,e,U),I(e,t),I(e,r),I(e,n);for(let j=0;j<o.length;j+=1)o[j]&&o[j].m(n,null);K&&K.m(n,null),I(e,l),I(e,c),I(c,u),I(c,f),I(f,d),I(c,p),I(c,v),I(e,k),C(y,e,null),I(e,V),I(e,x);for(let j=0;j<S.length;j+=1)S[j]&&S[j].m(x,null);$(L,fe,U),$(L,ee,U),I(ee,Q),I(ee,w),I(ee,re);for(let j=0;j<ie.length;j+=1)ie[j]&&ie[j].m(re,null);P=!0},p(L,U){if(U&12){q=be(L[3]),oe();for(let j=0;j<o.length;j+=1)o[j].r();o=ct(o,U,M,1,L,q,a,n,ut,Br,null,Nr);for(let j=0;j<o.length;j+=1)o[j].a();ae(),!q.length&&K?K.p(L,U):q.length?K&&(K.d(1),K=null):(K=Ur(),K.c(),K.m(n,null))}if((!P||U&8)&&h!==(h=L[3].length+"")&&ye(d,h),(!P||U&1032)&&b!==(b=L[3].length+L[10].length+"")&&ye(v,b),U&1028){N=be(L[10]),oe();for(let j=0;j<S.length;j+=1)S[j].r();S=ct(S,U,pe,1,L,N,W,x,ut,qr,null,Dr);for(let j=0;j<S.length;j+=1)S[j].a();ae()}if(U&32){ve=be(Object.keys(L[5]));let j;for(j=0;j<ve.length;j+=1){const Oe=Lr(L,ve,j);ie[j]?ie[j].p(Oe,U):(ie[j]=Fr(Oe),ie[j].c(),ie[j].m(re,null))}for(;j<ie.length;j+=1)ie[j].d(1);ie.length=ve.length}},i(L){if(!P){for(let U=0;U<q.length;U+=1)_(o[U]);_(y.$$.fragment,L);for(let U=0;U<N.length;U+=1)_(S[U]);P=!0}},o(L){for(let U=0;U<o.length;U+=1)g(o[U]);g(y.$$.fragment,L);for(let U=0;U<S.length;U+=1)g(S[U]);P=!1},d(L){L&&(m(e),m(fe),m(ee));for(let U=0;U<o.length;U+=1)o[U].d();K&&K.d(),O(y);for(let U=0;U<S.length;U+=1)S[U].d();Ht(ie,L)}}}function Oc(i){let e;return{c(){e=Y("Exit Room")},l(t){e=Z(t,"Exit Room")},m(t,s){$(t,e,s)},d(t){t&&m(e)}}}function Ac(i){let e,t;return e=new Je({props:{variant:"outline",href:"./",$$slots:{default:[Oc]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r&524288&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function jc(i){let e,t,s,r,n,o;return e=new $s({props:{$$slots:{default:[kc]},$$scope:{ctx:i}}}),s=new ks({props:{$$slots:{default:[Cc]},$$scope:{ctx:i}}}),n=new Ss({props:{class:"flex justify-between",$$slots:{default:[Ac]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=F(),T(s.$$.fragment),r=F(),T(n.$$.fragment)},l(a){E(e.$$.fragment,a),t=H(a),E(s.$$.fragment,a),r=H(a),E(n.$$.fragment,a)},m(a,l){C(e,a,l),$(a,t,l),C(s,a,l),$(a,r,l),C(n,a,l),o=!0},p(a,l){const c={};l&524288&&(c.$$scope={dirty:l,ctx:a}),e.$set(c);const u={};l&525356&&(u.$$scope={dirty:l,ctx:a}),s.$set(u);const f={};l&524288&&(f.$$scope={dirty:l,ctx:a}),n.$set(f)},i(a){o||(_(e.$$.fragment,a),_(s.$$.fragment,a),_(n.$$.fragment,a),o=!0)},o(a){g(e.$$.fragment,a),g(s.$$.fragment,a),g(n.$$.fragment,a),o=!1},d(a){a&&(m(t),m(r)),O(e,a),O(s,a),O(n,a)}}}function Rc(i){let e,t,s,r;const n=[yc,bc],o=[];function a(l,c){return l[4]=="preparation"?0:l[4]=="play"?1:-1}return~(e=a(i))&&(t=o[e]=n[e](i)),{c(){t&&t.c(),s=le()},l(l){t&&t.l(l),s=le()},m(l,c){~e&&o[e].m(l,c),$(l,s,c),r=!0},p(l,[c]){let u=e;e=a(l),e===u?~e&&o[e].p(l,c):(t&&(oe(),g(o[u],1,1,()=>{o[u]=null}),ae()),~e?(t=o[e],t?t.p(l,c):(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s)):t=null)},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),~e&&o[e].d(l)}}}function Ic(i,e,t){let s,{channel:r}=e,{username:n}=e,o="preparation",a={},l=[],c={mafia:1,detective:1,doctor:1,prostitute:1,villager:1},u=[],f={},h="Day",d={},p;return r.on("presence",{event:"sync"},()=>{const b=r.presenceState(),v={};let k=!1;for(let y in b)v[y]={...b[y][0]},a[y]||v[y].isHost&&k&&(p!=null&&Se.dismiss(p),p=Se.warning("Two or more hosts in this room.",{duration:Number.POSITIVE_INFINITY})),k=v[y].isHost||k;t(2,a=v)}).on("broadcast",{event:"preparation"},({payload:b})=>{t(4,o="preparation"),b.selectedPlayers&&t(3,l=b.selectedPlayers),b.rolesCount&&t(5,c=b.rolesCount)}).on("broadcast",{event:"play"},({payload:b})=>{t(4,o="play"),b.finalizedPlayers&&t(6,u=b.finalizedPlayers),b.gameTime&&t(8,h=b.gameTime),b.gameState&&t(9,d=b.gameState),b.assignedRoles&&t(7,f=b.assignedRoles)}),i.$$set=b=>{"channel"in b&&t(0,r=b.channel),"username"in b&&t(1,n=b.username)},i.$$.update=()=>{i.$$.dirty&12&&t(10,s=Object.keys(a).filter(b=>!l.some(v=>v==b)))},[r,n,a,l,o,c,u,f,h,d,s]}class Lc extends ge{constructor(e){super(),me(this,e,Ic,Rc,_e,{channel:0,username:1})}}function Dc(i){let e,t;return e=new Lc({props:{channel:i[1],username:i[0].username}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.username=s[0].username),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Nc(i){let e,t;return e=new vc({props:{channel:i[1],username:i[0].username}}),{c(){T(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,r){C(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.username=s[0].username),e.$set(n)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Uc(i){let e,t,s,r;const n=[Nc,Dc],o=[];function a(l,c){return l[0].gameType=="host"?0:l[0].gameType=="join"?1:-1}return~(e=a(i))&&(t=o[e]=n[e](i)),{c(){t&&t.c(),s=le()},l(l){t&&t.l(l),s=le()},m(l,c){~e&&o[e].m(l,c),$(l,s,c),r=!0},p(l,[c]){let u=e;e=a(l),e===u?~e&&o[e].p(l,c):(t&&(oe(),g(o[u],1,1,()=>{o[u]=null}),ae()),~e?(t=o[e],t?t.p(l,c):(t=o[e]=n[e](l),t.c()),_(t,1),t.m(s.parentNode,s)):t=null)},i(l){r||(_(t),r=!0)},o(l){g(t),r=!1},d(l){l&&m(s),~e&&o[e].d(l)}}}function Mc(i,e,t){let{data:s}=e;const r=lr.channel(s.gameId,{config:{broadcast:{self:s.gameType=="host"},presence:{key:s.username}}});return r.subscribe(n=>{if(n!="SUBSCRIBED")return null;r.track({user:s.username,isHost:s.gameType=="host"})}),Nn(()=>{lr.removeChannel(r)}),i.$$set=n=>{"data"in n&&t(0,s=n.data)},[s,r]}class ou extends ge{constructor(e){super(),me(this,e,Mc,Uc,_e,{data:0})}}export{ou as P,Xc as _,Yc as g};
